import{B as xs,l as Ye,Y as qe,s as He,$ as ze,m as Ss,p as Ls,q as As,y as Ps,z as Ds,H as R,k as t,j as E,g as We,a as s,A as Q,E as Oe,c as o,b as y,I as Rs,Q as Os,T as Vs,d as Ns,M as Ts,N as _s,o as Fs,i as r,r as k,e as S,F as B,u as a,R as Ke,t as u,S as fe,X as $s,G as N,V as js,h as $,f as Y,_ as Us}from"./index-DZl8BYRz.js";import{s as G,a as w,b as Z,e as me,c as Ms,d as H}from"./column.esm-Dm8uu_sK.js";import{s as ge}from"./textarea.esm-CQxn7aVK.js";import{s as Le}from"./dialog.esm-BoNSV5Rw.js";import{s as Bs}from"./progressbar.esm-BjufwUNN.js";import{s as Gs,a as Fe}from"./tabpanel.esm-Br8YNjIA.js";import"./virtualscroller.esm-ZInRXuSR.js";var Js={root:function(m){var P=m.props;return"p-message p-component p-message-"+P.severity},wrapper:"p-message-wrapper",icon:"p-message-icon",text:"p-message-text",closeButton:"p-message-close p-link",closeIcon:"p-message-close-icon"},Xs=xs.extend({name:"message",classes:Js}),Ys={name:"BaseMessage",extends:As,props:{severity:{type:String,default:"info"},closable:{type:Boolean,default:!0},sticky:{type:Boolean,default:!0},life:{type:Number,default:3e3},icon:{type:String,default:void 0},closeIcon:{type:String,default:void 0},closeButtonProps:{type:null,default:null}},style:Xs,provide:function(){return{$parentInstance:this}}},be={name:"Message",extends:Ys,inheritAttrs:!1,emits:["close","life-end"],timeout:null,data:function(){return{visible:!0}},watch:{sticky:function(m){m||this.closeAfterDelay()}},mounted:function(){this.sticky||this.closeAfterDelay()},methods:{close:function(m){this.visible=!1,this.$emit("close",m)},closeAfterDelay:function(){var m=this;setTimeout(function(){m.visible=!1,m.$emit("life-end")},this.life)}},computed:{iconComponent:function(){return{info:ze,success:He,warn:qe,error:Ye}[this.severity]},closeAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.close:void 0}},directives:{ripple:Ls},components:{TimesIcon:Ss,InfoCircleIcon:ze,CheckIcon:He,ExclamationTriangleIcon:qe,TimesCircleIcon:Ye}};function Ae(d){"@babel/helpers - typeof";return Ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},Ae(d)}function Qe(d,m){var P=Object.keys(d);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(d);m&&(g=g.filter(function(n){return Object.getOwnPropertyDescriptor(d,n).enumerable})),P.push.apply(P,g)}return P}function te(d){for(var m=1;m<arguments.length;m++){var P=arguments[m]!=null?arguments[m]:{};m%2?Qe(Object(P),!0).forEach(function(g){qs(d,g,P[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(P)):Qe(Object(P)).forEach(function(g){Object.defineProperty(d,g,Object.getOwnPropertyDescriptor(P,g))})}return d}function qs(d,m,P){return m=Hs(m),m in d?Object.defineProperty(d,m,{value:P,enumerable:!0,configurable:!0,writable:!0}):d[m]=P,d}function Hs(d){var m=zs(d,"string");return Ae(m)=="symbol"?m:String(m)}function zs(d,m){if(Ae(d)!="object"||!d)return d;var P=d[Symbol.toPrimitive];if(P!==void 0){var g=P.call(d,m);if(Ae(g)!="object")return g;throw new TypeError("@@toPrimitive must return a primitive value.")}return(m==="string"?String:Number)(d)}var Ws=["aria-label"];function Ks(d,m,P,g,n,A){var F=Ps("TimesIcon"),Ce=Ds("ripple");return t(),R(Vs,Q({name:"p-message",appear:""},d.ptmi("transition")),{default:E(function(){return[We(s("div",Q({class:d.cx("root"),role:"alert","aria-live":"assertive","aria-atomic":"true"},d.ptm("root")),[d.$slots.container?Oe(d.$slots,"container",{key:0,onClose:A.close,closeCallback:A.close}):(t(),o("div",Q({key:1,class:d.cx("wrapper")},d.ptm("wrapper")),[Oe(d.$slots,"messageicon",{class:"p-message-icon"},function(){return[(t(),R(Rs(d.icon?"span":A.iconComponent),Q({class:[d.cx("icon"),d.icon]},d.ptm("icon")),null,16,["class"]))]}),s("div",Q({class:["p-message-text",d.cx("text")]},d.ptm("text")),[Oe(d.$slots,"default")],16),d.closable?We((t(),o("button",Q({key:0,class:d.cx("closeButton"),"aria-label":A.closeAriaLabel,type:"button",onClick:m[0]||(m[0]=function(Pe){return A.close(Pe)})},te(te(te({},d.closeButtonProps),d.ptm("button")),d.ptm("closeButton"))),[Oe(d.$slots,"closeicon",{},function(){return[d.closeIcon?(t(),o("i",Q({key:0,class:[d.cx("closeIcon"),d.closeIcon]},te(te({},d.ptm("buttonIcon")),d.ptm("closeIcon"))),null,16)):(t(),R(F,Q({key:1,class:[d.cx("closeIcon"),d.closeIcon]},te(te({},d.ptm("buttonIcon")),d.ptm("closeIcon"))),null,16,["class"]))]})],16,Ws)),[[Ce]]):y("",!0)],16))],16),[[Os,n.visible]])]}),_:3},16)}be.render=Ks;const Qs={class:"curation-session"},Zs={key:0,class:"loading"},el={class:"page-header"},sl={class:"breadcrumb"},ll={class:"session-meta"},il={class:"header-actions"},tl={class:"progress-banner"},al={class:"progress-info"},nl={class:"progress-text"},ol={class:"progress-bar-container"},rl={class:"stats-row"},ul={class:"stat accepted"},dl={class:"value"},cl={class:"stat rejected"},vl={class:"value"},pl={class:"stat modified"},yl={class:"value"},fl={class:"stat pending"},ml={class:"value"},gl={key:0,class:"approval-banner"},bl={key:0,class:"comment"},Cl={class:"eu-warning-content"},Il={key:2,class:"pending-approval-banner"},wl={key:0},kl={class:"approval-actions"},El={key:3,class:"readiness-banner"},hl={class:"readiness-header"},xl={class:"readiness-checks"},Sl={key:0,class:"readiness-action"},Ll={class:"toolbar"},Al={class:"filters"},Pl={key:0,class:"bulk-actions"},Dl={key:0,class:"selected-count"},Rl={class:"section"},Ol={class:"dependency-cell"},Vl={class:"version"},Nl={class:"scope"},Tl={class:"license-badge original"},_l={key:0,class:"ai-suggestion"},Fl={class:"suggested-license"},$l={key:1,class:"no-suggestion"},jl={key:0,class:"spdx-suggestion"},Ul={class:"suggested-license"},Ml={class:"spdx-badges"},Bl={key:0,class:"spdx-badge spdx-osi"},Gl={key:1,class:"spdx-badge spdx-fsf"},Jl={key:2,class:"spdx-badge spdx-deprecated"},Xl={class:"spdx-name"},Yl={key:1,class:"spdx-suggestion from-ai"},ql={class:"suggested-license"},Hl={key:2,class:"no-suggestion"},zl={key:0,class:"license-badge curated"},Wl={key:1,class:"license-badge accepted"},Kl={key:2,class:"no-license"},Ql={key:0,class:"action-buttons"},Zl={key:0,class:"item-detail"},ei={class:"detail-section"},si={class:"info-grid"},li={class:"info-item"},ii={class:"info-item"},ti={class:"info-item"},ai={class:"info-item"},ni={class:"detail-section"},oi={class:"license-comparison"},ri={class:"license-box original"},ui={class:"license-box suggested"},di={class:"license-box spdx"},ci={key:0,class:"spdx-info-box"},vi={class:"spdx-details"},pi={class:"spdx-status-badges"},yi={key:0,class:"spdx-badge spdx-osi"},fi={key:1,class:"spdx-badge spdx-fsf"},mi={key:2,class:"spdx-badge spdx-deprecated"},gi={key:3,class:"spdx-badge spdx-warning"},bi={key:0,class:"spdx-links"},Ci=["href"],Ii={key:1,class:"spdx-info-box ai-source"},wi={class:"spdx-details"},ki={key:0,class:"alternatives"},Ei={key:2,class:"spdx-info-box missing"},hi={class:"spdx-details"},xi={key:3,class:"reasoning-box"},Si={key:0,class:"detail-section"},Li={class:"decision-form"},Ai={class:"action-selector"},Pi={key:0,class:"field"},Di={class:"field"},Ri={key:1,class:"detail-section"},Oi={class:"decision-summary"},Vi={key:0},Ni={key:1},Ti={key:2,class:"comment"},_i={key:0,class:"explanations-content"},Fi={key:0,class:"explanation-section"},$i={class:"exp-header"},ji={class:"rule-name"},Ui={class:"exp-summary"},Mi={key:0,class:"exp-details"},Bi={key:1,class:"explanation-section"},Gi={class:"exp-header"},Ji={class:"obl-name"},Xi={class:"exp-description"},Yi={key:0,class:"exp-detail"},qi={key:2,class:"explanation-section"},Hi={class:"exp-header"},zi={class:"exp-reason"},Wi={key:0,class:"exp-detail"},Ki={key:1,class:"exp-detail"},Qi={key:3,class:"explanation-section"},Zi={class:"exp-header"},et={class:"res-title"},st={class:"exp-description"},lt={key:0,class:"exp-steps"},it={key:4,class:"no-explanations"},tt={key:1,class:"explanations-loading"},at={class:"justification-content"},nt={class:"justification-form"},ot={class:"form-row"},rt={class:"field"},ut={class:"field"},dt={class:"field"},ct={class:"form-row"},vt={class:"field"},pt={class:"field"},yt={class:"field"},ft={class:"form-row"},mt={class:"field"},gt={class:"field"},bt={class:"bulk-action-content"},Ct={class:"action-selector"},It={class:"field"},wt={class:"approve-content"},kt={class:"approval-summary"},Et={class:"summary-item"},ht={class:"value"},xt={class:"summary-item accepted"},St={class:"value"},Lt={class:"summary-item rejected"},At={class:"value"},Pt={class:"summary-item modified"},Dt={class:"value"},Rt={class:"form-row"},Ot={class:"field"},Vt={class:"field"},Nt={class:"field"},Tt={class:"submit-approval-content"},_t={class:"readiness-summary"},Ft={class:"checklist"},$t={class:"check-item passed"},jt={class:"field"},Ut={class:"or-license-content"},Mt={key:0,class:"or-license-list"},Bt={class:"or-license-info"},Gt={class:"license-expression"},Jt={key:1,class:"or-license-resolver"},Xt={class:"or-license-header"},Yt={class:"version"},qt={class:"license-expression-display"},Ht={class:"field"},zt={class:"license-options"},Wt=["onClick"],Kt={class:"license-id"},Qt={class:"field"},Zt=Ns({__name:"CurationSessionView",setup(d){const m=js(),P=$s(),g=Ts(),n=k(null),A=k([]),F=k([]),Ce=k(!0),Pe=k(0),D=k(null),ee=k([]),T=k(null),Ie=k(null),we=k(null),ke=k(null),J=k(""),j=k(null),ae=k(!1),Ee=k(!1),se=k(!1),le=k(!1),ne=k(!1),c=k(null),_=k(null),O=k(!1),De=k(!1),oe=k(""),re=k(""),ue=k(""),x=k("ACCEPT"),z=k(""),q=k(""),L=k({spdxId:"",licenseCategory:"PERMISSIVE",concludedLicense:"",justificationType:"AI_ACCEPTED",justificationText:"",evidenceType:"",evidenceReference:"",distributionScope:"BINARY"}),W=k(""),de=k(""),Ze=[{label:"All Statuses",value:null},{label:"Pending",value:"PENDING"},{label:"Accepted",value:"ACCEPTED"},{label:"Rejected",value:"REJECTED"},{label:"Modified",value:"MODIFIED"}],es=[{label:"All Priorities",value:null},{label:"High",value:"HIGH"},{label:"Medium",value:"MEDIUM"},{label:"Low",value:"LOW"}],ss=[{label:"All Confidence",value:null},{label:"High",value:"HIGH"},{label:"Medium",value:"MEDIUM"},{label:"Low",value:"LOW"}],ls=[{label:"Permissive",value:"PERMISSIVE"},{label:"Weak Copyleft",value:"WEAK_COPYLEFT"},{label:"Strong Copyleft",value:"STRONG_COPYLEFT"},{label:"Network Copyleft (AGPL)",value:"NETWORK_COPYLEFT"},{label:"Proprietary",value:"PROPRIETARY"},{label:"Public Domain",value:"PUBLIC_DOMAIN"},{label:"Unknown",value:"UNKNOWN"}],is=[{label:"AI Accepted",value:"AI_ACCEPTED"},{label:"Manual Override",value:"MANUAL_OVERRIDE"},{label:"Evidence Based",value:"EVIDENCE_BASED"},{label:"Policy Exemption",value:"POLICY_EXEMPTION"},{label:"Legal Opinion",value:"LEGAL_OPINION"}],ts=[{label:"None",value:""},{label:"License File",value:"LICENSE_FILE"},{label:"Repository Inspection",value:"REPO_INSPECTION"},{label:"Vendor Confirmation",value:"VENDOR_CONFIRMATION"},{label:"Legal Opinion",value:"LEGAL_OPINION"},{label:"Prior Audit",value:"PRIOR_AUDIT"},{label:"Package Metadata",value:"PACKAGE_METADATA"}],as=[{label:"Internal Use Only",value:"INTERNAL"},{label:"Binary Distribution",value:"BINARY"},{label:"Source Distribution",value:"SOURCE"},{label:"SaaS / Cloud Service",value:"SAAS"},{label:"Embedded / Device",value:"EMBEDDED"}],ns=[{label:"Legal",value:"LEGAL"},{label:"Compliance",value:"COMPLIANCE"},{label:"Manager",value:"MANAGER"},{label:"Security",value:"SECURITY"}],os=fe(()=>!n.value||n.value.statistics.total===0?100:Math.round((n.value.statistics.total-n.value.statistics.pending)/n.value.statistics.total*100)),$e=fe(()=>{let i=[...A.value];if(Ie.value&&(i=i.filter(v=>v.status===Ie.value)),we.value&&(i=i.filter(v=>{var p;return((p=v.priority)==null?void 0:p.level)===we.value})),ke.value&&(i=i.filter(v=>{var p;return((p=v.aiSuggestion)==null?void 0:p.confidence)===ke.value})),J.value){const v=J.value.toLowerCase();i=i.filter(p=>{var C,l,f;return p.dependencyName.toLowerCase().includes(v)||((l=(C=p.aiSuggestion)==null?void 0:C.suggestedLicense)==null?void 0:l.toLowerCase().includes(v))||((f=p.originalConcludedLicense)==null?void 0:f.toLowerCase().includes(v))})}const e={HIGH:0,MEDIUM:1,LOW:2};return i.sort((v,p)=>{var f,b;if(v.status==="PENDING"&&p.status!=="PENDING")return-1;if(p.status==="PENDING"&&v.status!=="PENDING")return 1;const C=((f=v.priority)==null?void 0:f.level)||"LOW",l=((b=p.priority)==null?void 0:b.level)||"LOW";return(e[C]||2)-(e[l]||2)}),i}),je=fe(()=>{var i;return(i=D.value)!=null&&i.readiness?D.value.readiness.isReady&&!D.value.isSubmittedForApproval:!1}),Ve=fe(()=>{var i;return((i=D.value)==null?void 0:i.isSubmittedForApproval)||!1}),Re=fe(()=>{var v;if(!c.value)return!1;const i=z.value||((v=c.value.aiSuggestion)==null?void 0:v.suggestedLicense)||"";return["GPL","AGPL","LGPL","MPL","EPL","CDDL","Unknown","NOASSERTION","Proprietary"].some(p=>i.toUpperCase().includes(p.toUpperCase()))}),ce=fe(()=>ee.value.filter(i=>!i.isResolved).length);function rs(i){return j.value&&(i.dependencyName===j.value||i.dependencyName.toLowerCase()===j.value.toLowerCase())?"highlighted-row":""}async function ve(){Ce.value=!0;try{const i=m.params.id,e=await $.getCurationSessionByScan(i);n.value=e.data;const v=await $.listCurationItems(n.value.scanId,{pageSize:500});A.value=v.data.items,Pe.value=v.data.total}catch(i){console.error("Failed to fetch curation data",i),g.add({severity:"error",summary:"Error",detail:"Failed to load curation session",life:3e3})}finally{Ce.value=!1}}function Ne(i){var e;c.value=i,x.value=i.status==="PENDING"?"ACCEPT":i.status,z.value=i.curatedLicense||((e=i.aiSuggestion)==null?void 0:e.suggestedLicense)||"",q.value=i.curatorComment||"",ae.value=!0}async function us(){if(!(!c.value||!n.value)){O.value=!0;try{const i={action:x.value,license:x.value==="MODIFY"||x.value==="REJECT"?z.value:void 0,comment:q.value||void 0,curatorId:"curator"},e=await $.submitCurationDecision(n.value.scanId,c.value.dependencyId,i),v=A.value.findIndex(C=>C.id===c.value.id);v!==-1&&(A.value[v]=e.data);const p=await $.getCurationSession(n.value.scanId);n.value=p.data,ae.value=!1,g.add({severity:"success",summary:"Success",detail:"Decision saved",life:2e3})}catch(i){console.error("Failed to submit decision",i),g.add({severity:"error",summary:"Error",detail:"Failed to save decision",life:3e3})}finally{O.value=!1}}}function ds(){if(F.value.length===0){g.add({severity:"warn",summary:"Warning",detail:"Select items first",life:2e3});return}x.value="ACCEPT",q.value="",Ee.value=!0}async function cs(){if(!(F.value.length===0||!n.value)){O.value=!0;try{const i=F.value.map(v=>v.dependencyId),e={action:x.value,comment:q.value||void 0,curatorId:"curator"};await $.bulkCurationDecision(n.value.scanId,i,e),await ve(),F.value=[],Ee.value=!1,g.add({severity:"success",summary:"Success",detail:`Updated ${i.length} items`,life:2e3})}catch(i){console.error("Failed to submit bulk decision",i),g.add({severity:"error",summary:"Error",detail:"Failed to update items",life:3e3})}finally{O.value=!1}}}async function vs(i){if(n.value)try{const e=await $.submitCurationDecision(n.value.scanId,i.dependencyId,{action:"ACCEPT",curatorId:"curator"}),v=A.value.findIndex(C=>C.id===i.id);v!==-1&&(A.value[v]=e.data);const p=await $.getCurationSession(n.value.scanId);n.value=p.data}catch(e){console.error("Failed to accept",e),g.add({severity:"error",summary:"Error",detail:"Failed to accept",life:2e3})}}async function ps(i){if(n.value)try{const e=await $.submitCurationDecision(n.value.scanId,i.dependencyId,{action:"REJECT",curatorId:"curator"}),v=A.value.findIndex(C=>C.id===i.id);v!==-1&&(A.value[v]=e.data);const p=await $.getCurationSession(n.value.scanId);n.value=p.data}catch(e){console.error("Failed to reject",e),g.add({severity:"error",summary:"Error",detail:"Failed to reject",life:2e3})}}function Te(i){switch(i){case"ACCEPTED":return"success";case"REJECTED":return"danger";case"MODIFIED":return"info";case"PENDING":return"warning";default:return"secondary"}}function Ue(i){switch(i){case"CRITICAL":return"danger";case"HIGH":return"warning";case"MEDIUM":return"info";default:return"info"}}function ys(i){return i>=5?"Critical":i>=4?"High":i>=3?"Medium":i>=2?"Low":"Info"}function fs(i){return i>=5||i>=4?"danger":i>=3?"warning":i>=2?"info":"success"}function Me(i){switch(i){case"HIGH":return"confidence-high";case"MEDIUM":return"confidence-medium";default:return"confidence-low"}}function Be(i){return i?"spdx-valid":"spdx-invalid"}_s([Ie,we,ke,J],()=>{F.value=[]});async function he(){if(n.value)try{const i=await fetch(`/api/v1/scans/${n.value.scanId}/curation/approval/readiness`);i.ok&&(D.value=await i.json());const e=await fetch(`/api/v1/scans/${n.value.scanId}/curation/or-licenses`);if(e.ok){const v=await e.json();ee.value=v.items||[]}}catch(i){console.error("Failed to fetch EU compliance data",i)}}async function ms(i){if(n.value)try{const e=await fetch(`/api/v1/scans/${n.value.scanId}/curation/items/${i}/explanations`);e.ok&&(T.value=await e.json())}catch(e){console.error("Failed to fetch explanations",e),T.value=null}}async function gs(){var i,e;if(!(!c.value||!n.value)){O.value=!0;try{const v={action:x.value,license:x.value==="MODIFY"||x.value==="REJECT"?z.value:void 0,comment:q.value||void 0,justification:Re.value?{spdxId:L.value.spdxId||z.value||((i=c.value.aiSuggestion)==null?void 0:i.suggestedLicense),licenseCategory:L.value.licenseCategory,concludedLicense:L.value.concludedLicense||z.value||((e=c.value.aiSuggestion)==null?void 0:e.suggestedLicense),justificationType:L.value.justificationType,justificationText:L.value.justificationText,evidenceType:L.value.evidenceType||void 0,evidenceReference:L.value.evidenceReference||void 0,distributionScope:L.value.distributionScope}:void 0},p=await fetch(`/api/v1/scans/${n.value.scanId}/curation/items/${c.value.dependencyId}/decide`,{method:"POST",headers:{"Content-Type":"application/json","X-Curator-Id":"curator"},body:JSON.stringify(v)});if(!p.ok){const f=await p.json();throw new Error(f.error||"Failed to submit decision")}const C=await p.json(),l=A.value.findIndex(f=>f.id===c.value.id);l!==-1&&(A.value[l]=C.item),await ve(),await he(),ae.value=!1,ws(),g.add({severity:"success",summary:"Success",detail:"Decision saved with justification",life:2e3})}catch(v){console.error("Failed to submit decision",v),g.add({severity:"error",summary:"Error",detail:v.message||"Failed to save decision",life:3e3})}finally{O.value=!1}}}async function bs(){if(n.value){O.value=!0;try{const i=await fetch(`/api/v1/scans/${n.value.scanId}/curation/submit-for-approval`,{method:"POST",headers:{"Content-Type":"application/json","X-Curator-Id":"curator"},body:JSON.stringify({comment:re.value||void 0})});if(!i.ok){const e=await i.json();throw new Error(e.error||"Failed to submit for approval")}await ve(),await he(),ne.value=!1,g.add({severity:"success",summary:"Success",detail:"Session submitted for approval",life:3e3})}catch(i){console.error("Failed to submit for approval",i),g.add({severity:"error",summary:"Error",detail:i.message||"Failed to submit for approval",life:3e3})}finally{O.value=!1}}}async function Ge(i){if(!(!n.value||!oe.value||!ue.value)){O.value=!0;try{const e=await fetch(`/api/v1/scans/${n.value.scanId}/curation/approval/decide`,{method:"POST",headers:{"Content-Type":"application/json","X-Approver-Id":"approver","X-Approver-Name":oe.value,"X-Approver-Role":ue.value},body:JSON.stringify({decision:i,comment:re.value||void 0})});if(!e.ok){const p=await e.json();throw new Error(p.error||"Failed to process approval")}await ve(),await he(),se.value=!1;const v=i==="APPROVED"?"Session approved":"Session rejected";g.add({severity:i==="APPROVED"?"success":"warn",summary:v,detail:v,life:3e3})}catch(e){console.error("Failed to decide approval",e),g.add({severity:"error",summary:"Error",detail:e.message||"Failed to process approval",life:3e3})}finally{O.value=!1}}}async function Cs(){if(!(!n.value||!_.value||!W.value)){O.value=!0;try{const i=await fetch(`/api/v1/scans/${n.value.scanId}/curation/items/${_.value.dependencyId}/resolve-or`,{method:"POST",headers:{"Content-Type":"application/json","X-Curator-Id":"curator"},body:JSON.stringify({chosenLicense:W.value,reason:de.value})});if(!i.ok){const e=await i.json();throw new Error(e.error||"Failed to resolve OR license")}await ve(),await he(),le.value=!1,_.value=null,W.value="",de.value="",g.add({severity:"success",summary:"Success",detail:"OR license resolved",life:2e3})}catch(i){console.error("Failed to resolve OR license",i),g.add({severity:"error",summary:"Error",detail:i.message||"Failed to resolve OR license",life:3e3})}finally{O.value=!1}}}function Is(i){_.value=i,W.value="",de.value="",le.value=!0}function ws(){L.value={spdxId:"",licenseCategory:"PERMISSIVE",concludedLicense:"",justificationType:"AI_ACCEPTED",justificationText:"",evidenceType:"",evidenceReference:"",distributionScope:"BINARY"}}async function Je(i){Ne(i),await ms(i.dependencyId)}async function Xe(){var i,e,v;if(!(!c.value||!n.value)){De.value=!0;try{const p=await $.validateSpdxForItem(n.value.scanId,c.value.dependencyId),C=A.value.findIndex(l=>l.id===c.value.id);C!==-1&&(A.value[C]=p.data),c.value=p.data,g.add({severity:p.data.spdxValidated?"success":"warn",summary:p.data.spdxValidated?"SPDX Validated":"SPDX Not Found",detail:p.data.spdxValidated?`License validated as ${(i=p.data.spdxLicense)==null?void 0:i.licenseId}`:"License could not be found in SPDX database",life:3e3})}catch(p){console.error("Failed to validate SPDX",p),g.add({severity:"error",summary:"Validation Failed",detail:((v=(e=p.response)==null?void 0:e.data)==null?void 0:v.error)||"Failed to validate SPDX license",life:5e3})}finally{De.value=!1}}}async function ks(){if(n.value)try{const i=await fetch(`/api/v1/scans/${n.value.scanId}/curation/export/curations-yaml`);if(i.ok){const e=await i.json(),v=new Blob([e.content],{type:"text/yaml"}),p=URL.createObjectURL(v),C=document.createElement("a");C.href=p,C.download=e.filename||"curations.yml",C.click(),URL.revokeObjectURL(p),g.add({severity:"success",summary:"Exported",detail:"Curations YAML downloaded",life:2e3})}}catch(i){console.error("Failed to export curations",i),g.add({severity:"error",summary:"Error",detail:"Failed to export curations",life:3e3})}}async function Es(){if(n.value)try{const i=await fetch(`/api/v1/scans/${n.value.scanId}/curation/export/notice`);if(i.ok){const e=await i.json(),v=new Blob([e.content],{type:"text/plain"}),p=URL.createObjectURL(v),C=document.createElement("a");C.href=p,C.download=e.filename||"NOTICE",C.click(),URL.revokeObjectURL(p),g.add({severity:"success",summary:"Exported",detail:"NOTICE file downloaded",life:2e3})}}catch(i){console.error("Failed to export NOTICE",i),g.add({severity:"error",summary:"Error",detail:"Failed to export NOTICE",life:3e3})}}async function hs(){const i=m.query.search,e=m.query.highlight,v=m.query.dependencyId;if(i&&(J.value=i),e&&(j.value=e),await ve(),await he(),j.value||v){let p=A.value.find(C=>v&&C.dependencyId===v);if(!p&&j.value){const C=j.value.toLowerCase();p=A.value.find(l=>l.dependencyName===j.value)||A.value.find(l=>l.dependencyName.toLowerCase()===C)||A.value.find(l=>l.dependencyName.toLowerCase().includes(C)||C.includes(l.dependencyName.toLowerCase()))}if(p)j.value=p.dependencyName,J.value=p.dependencyName,g.add({severity:"info",summary:"Dependency Found",detail:`Showing "${p.dependencyName}" for curation review`,life:3e3}),Ne(p);else{const C=j.value||v||"",l=C.toLowerCase(),f=ee.value.find(b=>v&&b.dependencyId===v||b.dependencyName===C||b.dependencyName.toLowerCase()===l||b.dependencyName.toLowerCase().includes(l)||l.includes(b.dependencyName.toLowerCase()));if(f)j.value=f.dependencyName,J.value=f.dependencyName,g.add({severity:"info",summary:"OR License Found",detail:`"${f.dependencyName}" has an OR license expression that needs resolution`,life:4e3}),_.value=f,le.value=!0;else if(v){g.add({severity:"info",summary:"Adding to Curation",detail:`Adding "${C}" to the curation queue...`,life:2e3});try{const b=await $.addToCuration(n.value.scanId,v,"Policy violation: manual review required");if(b.data.success&&b.data.item){const h=await $.listCurationItems(n.value.scanId,{pageSize:500});A.value=h.data.items,Pe.value=h.data.total;const V=await $.getCurationSession(n.value.scanId);n.value=V.data;const U=A.value.find(ie=>ie.dependencyId===v);U&&(j.value=U.dependencyName,J.value=U.dependencyName,g.add({severity:"success",summary:"Added to Curation",detail:b.data.message,life:3e3}),Ne(U))}else g.add({severity:"error",summary:"Failed to Add",detail:b.data.message,life:5e3})}catch(b){console.error("Failed to add dependency to curation",b),g.add({severity:"error",summary:"Error",detail:"Failed to add dependency to curation queue",life:5e3})}}else g.add({severity:"warn",summary:"Dependency Not in Curation",detail:`"${C}" is not in the curation queue. Please try adding it from the scan details page.`,life:6e3}),J.value=C}P.replace({query:{}})}}return Fs(hs),(i,e)=>{var v,p,C;return t(),o("div",Qs,[Ce.value?(t(),o("div",Zs,[...e[47]||(e[47]=[s("i",{class:"pi pi-spin pi-spinner"},null,-1),S(" Loading curation session... ",-1)])])):n.value?(t(),o(B,{key:1},[s("header",el,[s("div",null,[s("div",sl,[r(a(Ke),{to:"/curations"},{default:E(()=>[...e[48]||(e[48]=[S("Curations",-1)])]),_:1}),e[49]||(e[49]=s("i",{class:"pi pi-angle-right"},null,-1)),e[50]||(e[50]=s("span",null,"Session Details",-1))]),e[52]||(e[52]=s("h1",null,"Curation Session",-1)),s("div",ll,[r(a(G),{value:n.value.status,severity:Te(n.value.status)},null,8,["value","severity"]),s("span",null,"Created: "+u(new Date(n.value.createdAt).toLocaleString()),1),r(a(Ke),{to:`/scans/${n.value.scanId}`,class:"scan-link"},{default:E(()=>[...e[51]||(e[51]=[s("i",{class:"pi pi-external-link"},null,-1),S(" View Scan ",-1)])]),_:1},8,["to"])])]),s("div",il,[je.value?(t(),R(a(w),{key:0,label:"Submit for Approval",icon:"pi pi-send",severity:"success",onClick:e[0]||(e[0]=l=>ne.value=!0)})):y("",!0),Ve.value&&n.value.status!=="APPROVED"?(t(),R(a(w),{key:1,label:"Review & Approve",icon:"pi pi-check",severity:"success",onClick:e[1]||(e[1]=l=>se.value=!0)})):y("",!0),n.value.status==="APPROVED"?(t(),R(a(w),{key:2,label:"Export YAML",icon:"pi pi-file-export",severity:"secondary",onClick:ks})):y("",!0),n.value.status==="APPROVED"?(t(),R(a(w),{key:3,label:"Export NOTICE",icon:"pi pi-file",severity:"secondary",onClick:Es})):y("",!0),n.value.status==="APPROVED"?(t(),R(a(w),{key:4,label:"View Scan",icon:"pi pi-external-link",severity:"secondary",onClick:e[2]||(e[2]=l=>a(P).push(`/scans/${n.value.scanId}`))})):y("",!0)])]),s("div",tl,[s("div",al,[e[53]||(e[53]=s("h3",null,"Progress",-1)),s("span",nl,u(n.value.statistics.total-n.value.statistics.pending)+" of "+u(n.value.statistics.total)+" items reviewed ",1)]),s("div",ol,[r(a(Bs),{value:os.value,style:{height:"12px"}},null,8,["value"])]),s("div",rl,[s("div",ul,[e[54]||(e[54]=s("i",{class:"pi pi-check"},null,-1)),s("span",dl,u(n.value.statistics.accepted),1),e[55]||(e[55]=s("span",{class:"label"},"Accepted",-1))]),s("div",cl,[e[56]||(e[56]=s("i",{class:"pi pi-times"},null,-1)),s("span",vl,u(n.value.statistics.rejected),1),e[57]||(e[57]=s("span",{class:"label"},"Rejected",-1))]),s("div",pl,[e[58]||(e[58]=s("i",{class:"pi pi-pencil"},null,-1)),s("span",yl,u(n.value.statistics.modified),1),e[59]||(e[59]=s("span",{class:"label"},"Modified",-1))]),s("div",fl,[e[60]||(e[60]=s("i",{class:"pi pi-clock"},null,-1)),s("span",ml,u(n.value.statistics.pending),1),e[61]||(e[61]=s("span",{class:"label"},"Pending",-1))])])]),n.value.status==="APPROVED"&&n.value.approval?(t(),o("div",gl,[e[63]||(e[63]=s("i",{class:"pi pi-check-circle"},null,-1)),s("div",null,[e[62]||(e[62]=s("strong",null,"Session Approved",-1)),s("p",null,"Approved by "+u(n.value.approval.approvedBy)+" on "+u(new Date(n.value.approval.approvedAt).toLocaleString()),1),n.value.approval.comment?(t(),o("p",bl,u(n.value.approval.comment),1)):y("",!0)])])):y("",!0),ce.value>0?(t(),R(a(be),{key:1,severity:"warn",closable:!1,class:"eu-message"},{default:E(()=>[s("div",Cl,[e[65]||(e[65]=s("i",{class:"pi pi-exclamation-triangle"},null,-1)),s("div",null,[s("strong",null,u(ce.value)+" Unresolved OR License(s)",1),e[64]||(e[64]=s("p",null,'Some dependencies have dual/multi-licensed options (e.g., "GPL-2.0 OR MIT"). You must explicitly choose which license applies before approval.',-1))]),r(a(w),{label:"Resolve OR Licenses",icon:"pi pi-list",severity:"warning",size:"small",onClick:e[3]||(e[3]=l=>{le.value=!0,_.value=ee.value.find(f=>!f.isResolved)})})])]),_:1})):y("",!0),Ve.value&&n.value.status!=="APPROVED"?(t(),o("div",Il,[e[68]||(e[68]=s("i",{class:"pi pi-clock"},null,-1)),s("div",null,[e[66]||(e[66]=s("strong",null,"Awaiting Approval",-1)),e[67]||(e[67]=s("p",null,"This session has been submitted for approval and is awaiting review by a different person (EU four-eyes principle).",-1)),(v=D.value)!=null&&v.submittedBy?(t(),o("p",wl,"Submitted by: "+u(D.value.submittedBy),1)):y("",!0)]),s("div",kl,[r(a(w),{label:"Approve",icon:"pi pi-check",severity:"success",size:"small",onClick:e[4]||(e[4]=l=>se.value=!0)}),r(a(w),{label:"Reject",icon:"pi pi-times",severity:"danger",size:"small",outlined:"",onClick:e[5]||(e[5]=l=>se.value=!0)})])])):y("",!0),(p=D.value)!=null&&p.readiness&&!Ve.value&&n.value.status!=="APPROVED"?(t(),o("div",El,[s("div",hl,[e[69]||(e[69]=s("h4",null,"Approval Readiness",-1)),r(a(G),{value:D.value.readiness.isReady?"Ready":"Not Ready",severity:D.value.readiness.isReady?"success":"warning"},null,8,["value","severity"])]),s("div",xl,[s("div",{class:N(["check-item",{passed:D.value.readiness.allItemsCurated}])},[s("i",{class:N(D.value.readiness.allItemsCurated?"pi pi-check-circle":"pi pi-circle")},null,2),s("span",null,"All items curated ("+u(n.value.statistics.total-n.value.statistics.pending)+"/"+u(n.value.statistics.total)+")",1)],2),s("div",{class:N(["check-item",{passed:D.value.readiness.allJustificationsComplete}])},[s("i",{class:N(D.value.readiness.allJustificationsComplete?"pi pi-check-circle":"pi pi-circle")},null,2),s("span",null,"All justifications complete ("+u(D.value.readiness.justificationsComplete||0)+"/"+u(D.value.readiness.justificationsRequired||0)+")",1)],2),s("div",{class:N(["check-item",{passed:D.value.readiness.allOrLicensesResolved}])},[s("i",{class:N(D.value.readiness.allOrLicensesResolved?"pi pi-check-circle":"pi pi-circle")},null,2),s("span",null,"All OR licenses resolved ("+u((ee.value.length||0)-ce.value)+"/"+u(ee.value.length||0)+")",1)],2)]),je.value?(t(),o("div",Sl,[r(a(w),{label:"Submit for Approval",icon:"pi pi-send",severity:"success",onClick:e[6]||(e[6]=l=>ne.value=!0)})])):y("",!0)])):y("",!0),s("div",Ll,[s("div",Al,[r(a(Z),{modelValue:Ie.value,"onUpdate:modelValue":e[7]||(e[7]=l=>Ie.value=l),options:Ze,optionLabel:"label",optionValue:"value",placeholder:"Status",class:"filter-dropdown"},null,8,["modelValue"]),r(a(Z),{modelValue:we.value,"onUpdate:modelValue":e[8]||(e[8]=l=>we.value=l),options:es,optionLabel:"label",optionValue:"value",placeholder:"Priority",class:"filter-dropdown"},null,8,["modelValue"]),r(a(Z),{modelValue:ke.value,"onUpdate:modelValue":e[9]||(e[9]=l=>ke.value=l),options:ss,optionLabel:"label",optionValue:"value",placeholder:"Confidence",class:"filter-dropdown"},null,8,["modelValue"]),r(a(me),{modelValue:J.value,"onUpdate:modelValue":e[10]||(e[10]=l=>J.value=l),placeholder:"Search dependencies...",class:"search-input"},null,8,["modelValue"])]),n.value.status!=="APPROVED"?(t(),o("div",Pl,[F.value.length>0?(t(),o("span",Dl,u(F.value.length)+" selected ",1)):y("",!0),r(a(w),{label:"Bulk Action",icon:"pi pi-list",severity:"secondary",disabled:F.value.length===0,onClick:ds},null,8,["disabled"])])):y("",!0)]),s("div",Rl,[r(a(Ms),{selection:F.value,"onUpdate:selection":e[11]||(e[11]=l=>F.value=l),value:$e.value,stripedRows:"",showGridlines:"",class:"p-datatable-sm",paginator:$e.value.length>20,rows:20,dataKey:"id",selectionMode:(n.value.status!=="APPROVED",void 0),rowClass:rs},{default:E(()=>[n.value.status!=="APPROVED"?(t(),R(a(H),{key:0,selectionMode:"multiple",style:{width:"50px"}})):y("",!0),r(a(H),{field:"dependencyName",header:"Dependency",style:{"min-width":"250px"},sortable:""},{body:E(({data:l})=>[s("div",Ol,[s("strong",null,u(l.dependencyName),1),s("span",Vl,"@"+u(l.dependencyVersion),1),s("div",Nl,u(l.scope),1)])]),_:1}),r(a(H),{header:"Original License",style:{width:"150px"}},{body:E(({data:l})=>[s("span",Tl,u(l.originalConcludedLicense||"Unknown"),1)]),_:1}),r(a(H),{header:"AI Suggestion",style:{"min-width":"200px"}},{body:E(({data:l})=>{var f;return[(f=l.aiSuggestion)!=null&&f.suggestedLicense?(t(),o("div",_l,[s("span",Fl,u(l.aiSuggestion.suggestedLicense),1),s("span",{class:N(["confidence",Me(l.aiSuggestion.confidence)])},u(l.aiSuggestion.confidence),3)])):(t(),o("span",$l,"No AI suggestion"))]}),_:1}),r(a(H),{header:"SPDX License",style:{"min-width":"220px"}},{body:E(({data:l})=>{var f,b;return[(f=l.spdxLicense)!=null&&f.licenseId?(t(),o("div",jl,[s("span",Ul,u(l.spdxLicense.licenseId),1),s("div",Ml,[s("span",{class:N(["spdx-badge",Be(l.spdxValidated)])},u(l.spdxValidated?"✓ Valid":"⚠ Invalid"),3),l.spdxLicense.isOsiApproved?(t(),o("span",Bl,"OSI")):y("",!0),l.spdxLicense.isFsfLibre?(t(),o("span",Gl,"FSF")):y("",!0),l.spdxLicense.isDeprecated?(t(),o("span",Jl,"Deprecated")):y("",!0)]),s("span",Xl,u(l.spdxLicense.name),1)])):(b=l.aiSuggestion)!=null&&b.spdxId?(t(),o("div",Yl,[s("span",ql,u(l.aiSuggestion.spdxId),1),e[70]||(e[70]=s("span",{class:"spdx-badge spdx-ai"},"From AI",-1))])):(t(),o("span",Hl,"No SPDX info"))]}),_:1}),r(a(H),{field:"priority",header:"Priority",style:{width:"100px"},sortable:""},{body:E(({data:l})=>{var f,b;return[r(a(G),{value:(f=l.priority)==null?void 0:f.level,severity:Ue((b=l.priority)==null?void 0:b.level)},null,8,["value","severity"])]}),_:1}),r(a(H),{field:"status",header:"Status",style:{width:"110px"},sortable:""},{body:E(({data:l})=>[r(a(G),{value:l.status,severity:Te(l.status)},null,8,["value","severity"])]),_:1}),r(a(H),{header:"Final License",style:{width:"150px"}},{body:E(({data:l})=>{var f;return[l.curatedLicense?(t(),o("span",zl,u(l.curatedLicense),1)):l.status==="ACCEPTED"?(t(),o("span",Wl,u((f=l.aiSuggestion)==null?void 0:f.suggestedLicense),1)):(t(),o("span",Kl,"-"))]}),_:1}),r(a(H),{header:"Actions",style:{width:"150px"}},{body:E(({data:l})=>{var f;return[((f=n.value)==null?void 0:f.status)!=="APPROVED"?(t(),o("div",Ql,[l.status==="PENDING"?(t(),R(a(w),{key:0,icon:"pi pi-check",severity:"success",text:"",rounded:"",size:"small",onClick:b=>vs(l),title:"Accept"},null,8,["onClick"])):y("",!0),l.status==="PENDING"?(t(),R(a(w),{key:1,icon:"pi pi-times",severity:"danger",text:"",rounded:"",size:"small",onClick:b=>ps(l),title:"Reject"},null,8,["onClick"])):y("",!0),r(a(w),{icon:"pi pi-pencil",severity:"secondary",text:"",rounded:"",size:"small",onClick:b=>Je(l),title:"Edit with Explanations"},null,8,["onClick"])])):(t(),R(a(w),{key:1,icon:"pi pi-eye",severity:"secondary",text:"",rounded:"",size:"small",onClick:b=>Je(l),title:"View Details"},null,8,["onClick"]))]}),_:1})]),_:1},8,["selection","value","paginator","selectionMode"])])],64)):y("",!0),r(a(Le),{visible:ae.value,"onUpdate:visible":e[27]||(e[27]=l=>ae.value=l),header:((C=c.value)==null?void 0:C.dependencyName)||"Item Details",modal:!0,style:{width:"900px"}},{footer:E(()=>{var l;return[r(a(w),{label:"Cancel",severity:"secondary",onClick:e[25]||(e[25]=f=>ae.value=!1)}),((l=n.value)==null?void 0:l.status)!=="APPROVED"?(t(),R(a(w),{key:0,label:Re.value?"Save with Justification":"Save Decision",icon:"pi pi-check",onClick:e[26]||(e[26]=f=>Re.value?gs():us()),loading:O.value},null,8,["label","loading"])):y("",!0)]}),default:E(()=>[c.value?(t(),o("div",Zl,[r(a(Gs),null,{default:E(()=>{var l;return[r(a(Fe),{header:"Decision"},{default:E(()=>{var f,b,h,V,U,ie,xe,Se,I,X,K,pe,ye;return[s("div",ei,[e[75]||(e[75]=s("h4",null,"Dependency Information",-1)),s("div",si,[s("div",li,[e[71]||(e[71]=s("label",null,"Name",-1)),s("span",null,u(c.value.dependencyName),1)]),s("div",ii,[e[72]||(e[72]=s("label",null,"Version",-1)),s("span",null,u(c.value.dependencyVersion),1)]),s("div",ti,[e[73]||(e[73]=s("label",null,"Scope",-1)),s("span",null,u(c.value.scope),1)]),s("div",ai,[e[74]||(e[74]=s("label",null,"Priority",-1)),r(a(G),{value:(f=c.value.priority)==null?void 0:f.level,severity:Ue((b=c.value.priority)==null?void 0:b.level)},null,8,["value","severity"])])])]),s("div",ni,[e[96]||(e[96]=s("h4",null,"License Information",-1)),s("div",oi,[s("div",ri,[e[76]||(e[76]=s("label",null,"Original License",-1)),s("span",null,u(c.value.originalConcludedLicense||"Unknown"),1)]),e[79]||(e[79]=s("i",{class:"pi pi-arrow-right"},null,-1)),s("div",ui,[e[77]||(e[77]=s("label",null,"AI Suggested",-1)),s("span",null,u(((h=c.value.aiSuggestion)==null?void 0:h.suggestedLicense)||"None"),1),(V=c.value.aiSuggestion)!=null&&V.confidence?(t(),o("span",{key:0,class:N(["confidence-badge",Me(c.value.aiSuggestion.confidence)])},u(c.value.aiSuggestion.confidence),3)):y("",!0)]),e[80]||(e[80]=s("i",{class:"pi pi-arrow-right"},null,-1)),s("div",di,[e[78]||(e[78]=s("label",null,"SPDX Validated",-1)),s("span",null,u(((U=c.value.spdxLicense)==null?void 0:U.licenseId)||((ie=c.value.aiSuggestion)==null?void 0:ie.spdxId)||"None"),1),c.value.spdxLicense||(xe=c.value.aiSuggestion)!=null&&xe.spdxId?(t(),o("span",{key:0,class:N(["spdx-badge",Be(c.value.spdxValidated)])},u(c.value.spdxValidated?"✓ Valid":"⚠ Needs Review"),3)):y("",!0)])]),c.value.spdxLicense?(t(),o("div",ci,[e[88]||(e[88]=s("label",null,[s("i",{class:"pi pi-verified"}),S(" SPDX License Details")],-1)),s("div",vi,[s("p",null,[e[81]||(e[81]=s("strong",null,"License ID:",-1)),S(" "+u(c.value.spdxLicense.licenseId),1)]),s("p",null,[e[82]||(e[82]=s("strong",null,"Full Name:",-1)),S(" "+u(c.value.spdxLicense.name),1)]),s("div",pi,[c.value.spdxLicense.isOsiApproved?(t(),o("span",yi,[...e[83]||(e[83]=[s("i",{class:"pi pi-check-circle"},null,-1),S(" OSI Approved ",-1)])])):y("",!0),c.value.spdxLicense.isFsfLibre?(t(),o("span",fi,[...e[84]||(e[84]=[s("i",{class:"pi pi-check-circle"},null,-1),S(" FSF Free/Libre ",-1)])])):y("",!0),c.value.spdxLicense.isDeprecated?(t(),o("span",mi,[...e[85]||(e[85]=[s("i",{class:"pi pi-exclamation-triangle"},null,-1),S(" Deprecated ",-1)])])):y("",!0),!c.value.spdxLicense.isOsiApproved&&!c.value.spdxLicense.isFsfLibre?(t(),o("span",gi,[...e[86]||(e[86]=[s("i",{class:"pi pi-info-circle"},null,-1),S(" Not OSI/FSF Approved ",-1)])])):y("",!0)]),(Se=c.value.spdxLicense.seeAlso)!=null&&Se.length?(t(),o("div",bi,[e[87]||(e[87]=s("strong",null,"References:",-1)),s("ul",null,[(t(!0),o(B,null,Y(c.value.spdxLicense.seeAlso.slice(0,3),(M,_e)=>(t(),o("li",{key:_e},[s("a",{href:M,target:"_blank",rel:"noopener"},u(M),9,Ci)]))),128))])])):y("",!0)])])):(I=c.value.aiSuggestion)!=null&&I.spdxId?(t(),o("div",Ii,[e[92]||(e[92]=s("label",null,[s("i",{class:"pi pi-sparkles"}),S(" AI SPDX Suggestion")],-1)),s("div",wi,[s("p",null,[e[89]||(e[89]=s("strong",null,"Suggested SPDX ID:",-1)),S(" "+u(c.value.aiSuggestion.spdxId),1)]),e[91]||(e[91]=s("p",{class:"ai-note"},[s("i",{class:"pi pi-info-circle"}),S(" This SPDX ID was suggested by AI and may need validation.")],-1)),(X=c.value.aiSuggestion.alternatives)!=null&&X.length?(t(),o("div",ki,[e[90]||(e[90]=s("strong",null,"Alternative suggestions:",-1)),(t(!0),o(B,null,Y(c.value.aiSuggestion.alternatives,(M,_e)=>(t(),o("span",{key:_e,class:"alt-badge"},u(M),1))),128))])):y("",!0),r(a(w),{label:"Validate SPDX",icon:"pi pi-check-circle",severity:"info",size:"small",class:"mt-2",loading:De.value,onClick:Xe},null,8,["loading"])])])):!c.value.spdxLicense&&!((K=c.value.aiSuggestion)!=null&&K.spdxId)?(t(),o("div",Ei,[e[94]||(e[94]=s("label",null,[s("i",{class:"pi pi-exclamation-circle"}),S(" No SPDX Information")],-1)),s("div",hi,[e[93]||(e[93]=s("p",null,"This license has not been validated against the SPDX license list.",-1)),r(a(w),{label:"Validate SPDX",icon:"pi pi-check-circle",severity:"info",size:"small",class:"mt-2",loading:De.value,onClick:Xe},null,8,["loading"])])])):y("",!0),(pe=c.value.aiSuggestion)!=null&&pe.reasoning?(t(),o("div",xi,[e[95]||(e[95]=s("label",null,"AI Reasoning",-1)),s("p",null,u(c.value.aiSuggestion.reasoning),1)])):y("",!0)]),((ye=n.value)==null?void 0:ye.status)!=="APPROVED"?(t(),o("div",Si,[e[99]||(e[99]=s("h4",null,"Your Decision",-1)),s("div",Li,[s("div",Ai,[r(a(w),{label:"Accept",severity:x.value==="ACCEPT"?"success":"secondary",outlined:x.value!=="ACCEPT",onClick:e[12]||(e[12]=M=>x.value="ACCEPT")},null,8,["severity","outlined"]),r(a(w),{label:"Reject",severity:x.value==="REJECT"?"danger":"secondary",outlined:x.value!=="REJECT",onClick:e[13]||(e[13]=M=>x.value="REJECT")},null,8,["severity","outlined"]),r(a(w),{label:"Modify",severity:x.value==="MODIFY"?"info":"secondary",outlined:x.value!=="MODIFY",onClick:e[14]||(e[14]=M=>x.value="MODIFY")},null,8,["severity","outlined"])]),x.value==="MODIFY"?(t(),o("div",Pi,[e[97]||(e[97]=s("label",null,"Custom License",-1)),r(a(me),{modelValue:z.value,"onUpdate:modelValue":e[15]||(e[15]=M=>z.value=M),placeholder:"Enter SPDX license ID...",class:"w-full"},null,8,["modelValue"])])):y("",!0),s("div",Di,[e[98]||(e[98]=s("label",null,"Comment (optional)",-1)),r(a(ge),{modelValue:q.value,"onUpdate:modelValue":e[16]||(e[16]=M=>q.value=M),rows:"2",class:"w-full",placeholder:"Add a note about this decision..."},null,8,["modelValue"])])])])):(t(),o("div",Ri,[e[100]||(e[100]=s("h4",null,"Decision",-1)),s("div",Oi,[r(a(G),{value:c.value.status,severity:Te(c.value.status)},null,8,["value","severity"]),c.value.curatedLicense?(t(),o("span",Vi,"License: "+u(c.value.curatedLicense),1)):y("",!0),c.value.curatorId?(t(),o("span",Ni,"By: "+u(c.value.curatorId),1)):y("",!0),c.value.curatorComment?(t(),o("p",Ti,u(c.value.curatorComment),1)):y("",!0)])]))]}),_:1}),r(a(Fe),{header:"Explanations"},{default:E(()=>{var f,b,h,V,U,ie,xe,Se;return[T.value?(t(),o("div",_i,[(f=T.value.whyNotExplanations)!=null&&f.length?(t(),o("div",Fi,[e[101]||(e[101]=s("h4",null,[s("i",{class:"pi pi-question-circle"}),S(" Why This License Needs Attention")],-1)),(t(!0),o(B,null,Y(T.value.whyNotExplanations,(I,X)=>{var K;return t(),o("div",{key:X,class:"explanation-card violation"},[s("div",$i,[r(a(G),{value:ys(I.riskLevel),severity:fs(I.riskLevel)},null,8,["value","severity"]),s("span",ji,u(I.title),1)]),s("p",Ui,u(I.summary),1),(K=I.details)!=null&&K.length?(t(),o("div",Mi,[s("ul",null,[(t(!0),o(B,null,Y(I.details,(pe,ye)=>(t(),o("li",{key:ye},u(pe),1))),128))])])):y("",!0)])}),128))])):y("",!0),(b=T.value.triggeredObligations)!=null&&b.length?(t(),o("div",Bi,[e[103]||(e[103]=s("h4",null,[s("i",{class:"pi pi-list-check"}),S(" License Obligations")],-1)),(t(!0),o(B,null,Y(T.value.triggeredObligations,(I,X)=>(t(),o("div",{key:X,class:"explanation-card obligation"},[s("div",Gi,[r(a(G),{value:I.effort,severity:I.effort==="HIGH"?"danger":I.effort==="MEDIUM"?"warning":"info"},null,8,["value","severity"]),s("span",Ji,u(I.name),1),I.isRequired?(t(),R(a(G),{key:0,value:"Required",severity:"danger",class:"ml-2"})):y("",!0)]),s("p",Xi,u(I.description),1),I.scope?(t(),o("div",Yi,[e[102]||(e[102]=s("strong",null,"Scope:",-1)),S(" "+u(I.scope),1)])):y("",!0)]))),128))])):y("",!0),(h=T.value.compatibilityIssues)!=null&&h.length?(t(),o("div",qi,[e[106]||(e[106]=s("h4",null,[s("i",{class:"pi pi-exclamation-triangle"}),S(" Compatibility Issues")],-1)),(t(!0),o(B,null,Y(T.value.compatibilityIssues,(I,X)=>(t(),o("div",{key:X,class:"explanation-card compatibility"},[s("div",Hi,[r(a(G),{value:I.compatibilityLevel,severity:I.compatibilityLevel==="INCOMPATIBLE"?"danger":"warning"},null,8,["value","severity"]),s("span",null,u(I.currentLicense)+" ↔ "+u(I.otherLicense),1)]),s("p",zi,u(I.reason),1),I.otherDependencyName?(t(),o("div",Wi,[e[104]||(e[104]=s("strong",null,"Affected:",-1)),S(" "+u(I.otherDependencyName),1)])):y("",!0),I.recommendation?(t(),o("div",Ki,[e[105]||(e[105]=s("strong",null,"Recommendation:",-1)),S(" "+u(I.recommendation),1)])):y("",!0)]))),128))])):y("",!0),(V=T.value.resolutions)!=null&&V.length?(t(),o("div",Qi,[e[108]||(e[108]=s("h4",null,[s("i",{class:"pi pi-lightbulb"}),S(" Resolution Options")],-1)),(t(!0),o(B,null,Y(T.value.resolutions,(I,X)=>{var K;return t(),o("div",{key:X,class:"explanation-card resolution"},[s("div",Zi,[r(a(G),{value:I.effort,severity:I.effort==="HIGH"?"danger":I.effort==="MEDIUM"?"warning":"success"},null,8,["value","severity"]),s("span",et,u(I.title),1)]),s("p",st,u(I.description),1),(K=I.steps)!=null&&K.length?(t(),o("div",lt,[e[107]||(e[107]=s("strong",null,"Steps:",-1)),s("ol",null,[(t(!0),o(B,null,Y(I.steps,(pe,ye)=>(t(),o("li",{key:ye},u(pe),1))),128))])])):y("",!0)])}),128))])):y("",!0),!((U=T.value.whyNotExplanations)!=null&&U.length)&&!((ie=T.value.triggeredObligations)!=null&&ie.length)&&!((xe=T.value.compatibilityIssues)!=null&&xe.length)&&!((Se=T.value.resolutions)!=null&&Se.length)?(t(),o("div",it,[...e[109]||(e[109]=[s("i",{class:"pi pi-check-circle"},null,-1),s("p",null,"No policy violations, obligations, or compatibility issues found for this dependency.",-1)])])):y("",!0)])):(t(),o("div",tt,[...e[110]||(e[110]=[s("i",{class:"pi pi-spin pi-spinner"},null,-1),S(" Loading explanations... ",-1)])]))]}),_:1}),((l=n.value)==null?void 0:l.status)!=="APPROVED"?(t(),R(a(Fe),{key:0,header:"Justification"},{default:E(()=>{var f,b;return[s("div",at,[Re.value?(t(),R(a(be),{key:0,severity:"info",closable:!1},{default:E(()=>[...e[111]||(e[111]=[s("strong",null,"EU Compliance:",-1),S(" This license requires a structured justification for audit purposes. ",-1)])]),_:1})):y("",!0),s("div",nt,[s("div",ot,[s("div",rt,[e[112]||(e[112]=s("label",null,"SPDX License ID *",-1)),r(a(me),{modelValue:L.value.spdxId,"onUpdate:modelValue":e[17]||(e[17]=h=>L.value.spdxId=h),placeholder:((f=c.value.aiSuggestion)==null?void 0:f.suggestedLicense)||"e.g., MIT, GPL-3.0-only",class:"w-full"},null,8,["modelValue","placeholder"])]),s("div",ut,[e[113]||(e[113]=s("label",null,"License Category *",-1)),r(a(Z),{modelValue:L.value.licenseCategory,"onUpdate:modelValue":e[18]||(e[18]=h=>L.value.licenseCategory=h),options:ls,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue"])])]),s("div",dt,[e[114]||(e[114]=s("label",null,"Concluded License *",-1)),r(a(me),{modelValue:L.value.concludedLicense,"onUpdate:modelValue":e[19]||(e[19]=h=>L.value.concludedLicense=h),placeholder:((b=c.value.aiSuggestion)==null?void 0:b.suggestedLicense)||"Final license determination",class:"w-full"},null,8,["modelValue","placeholder"])]),s("div",ct,[s("div",vt,[e[115]||(e[115]=s("label",null,"Justification Type *",-1)),r(a(Z),{modelValue:L.value.justificationType,"onUpdate:modelValue":e[20]||(e[20]=h=>L.value.justificationType=h),options:is,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue"])]),s("div",pt,[e[116]||(e[116]=s("label",null,"Distribution Scope *",-1)),r(a(Z),{modelValue:L.value.distributionScope,"onUpdate:modelValue":e[21]||(e[21]=h=>L.value.distributionScope=h),options:as,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue"])])]),s("div",yt,[e[117]||(e[117]=s("label",null,"Justification Text *",-1)),r(a(ge),{modelValue:L.value.justificationText,"onUpdate:modelValue":e[22]||(e[22]=h=>L.value.justificationText=h),rows:"3",class:"w-full",placeholder:"Explain why this license determination is correct and acceptable for your use case..."},null,8,["modelValue"])]),s("div",ft,[s("div",mt,[e[118]||(e[118]=s("label",null,"Evidence Type",-1)),r(a(Z),{modelValue:L.value.evidenceType,"onUpdate:modelValue":e[23]||(e[23]=h=>L.value.evidenceType=h),options:ts,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue"])]),s("div",gt,[e[119]||(e[119]=s("label",null,"Evidence Reference",-1)),r(a(me),{modelValue:L.value.evidenceReference,"onUpdate:modelValue":e[24]||(e[24]=h=>L.value.evidenceReference=h),placeholder:"URL or document reference...",class:"w-full"},null,8,["modelValue"])])])])])]}),_:1})):y("",!0)]}),_:1})])):y("",!0)]),_:1},8,["visible","header"]),r(a(Le),{visible:Ee.value,"onUpdate:visible":e[32]||(e[32]=l=>Ee.value=l),header:"Bulk Action",modal:!0,style:{width:"500px"}},{footer:E(()=>[r(a(w),{label:"Cancel",severity:"secondary",onClick:e[31]||(e[31]=l=>Ee.value=!1)}),r(a(w),{label:"Apply",icon:"pi pi-check",severity:x.value==="ACCEPT"?"success":"danger",onClick:cs,loading:O.value},null,8,["severity","loading"])]),default:E(()=>[s("div",bt,[s("p",null,"Apply action to "+u(F.value.length)+" selected items:",1),s("div",Ct,[r(a(w),{label:"Accept All",severity:x.value==="ACCEPT"?"success":"secondary",outlined:x.value!=="ACCEPT",onClick:e[28]||(e[28]=l=>x.value="ACCEPT")},null,8,["severity","outlined"]),r(a(w),{label:"Reject All",severity:x.value==="REJECT"?"danger":"secondary",outlined:x.value!=="REJECT",onClick:e[29]||(e[29]=l=>x.value="REJECT")},null,8,["severity","outlined"])]),s("div",It,[e[120]||(e[120]=s("label",null,"Comment (optional)",-1)),r(a(ge),{modelValue:q.value,"onUpdate:modelValue":e[30]||(e[30]=l=>q.value=l),rows:"2",class:"w-full",placeholder:"Add a note for all items..."},null,8,["modelValue"])])])]),_:1},8,["visible"]),r(a(Le),{visible:se.value,"onUpdate:visible":e[39]||(e[39]=l=>se.value=l),header:"Review & Approve Curation Session",modal:!0,style:{width:"550px"}},{footer:E(()=>[r(a(w),{label:"Cancel",severity:"secondary",onClick:e[36]||(e[36]=l=>se.value=!1)}),r(a(w),{label:"Reject",icon:"pi pi-times",severity:"danger",outlined:"",onClick:e[37]||(e[37]=l=>Ge("REJECTED")),loading:O.value,disabled:!oe.value||!ue.value},null,8,["loading","disabled"]),r(a(w),{label:"Approve",icon:"pi pi-check",severity:"success",onClick:e[38]||(e[38]=l=>Ge("APPROVED")),loading:O.value,disabled:!oe.value||!ue.value},null,8,["loading","disabled"])]),default:E(()=>{var l,f,b,h;return[s("div",wt,[r(a(be),{severity:"info",closable:!1,class:"eu-notice"},{default:E(()=>[...e[121]||(e[121]=[s("strong",null,"EU Four-Eyes Principle:",-1),S(" The approver must be a different person than the curator who made the decisions. ",-1)])]),_:1}),e[129]||(e[129]=s("p",null,"You are reviewing this curation session for final approval. Please verify that all license decisions are correct and properly documented.",-1)),s("div",kt,[s("div",Et,[e[122]||(e[122]=s("span",{class:"label"},"Total Items",-1)),s("span",ht,u((l=n.value)==null?void 0:l.statistics.total),1)]),s("div",xt,[e[123]||(e[123]=s("span",{class:"label"},"Accepted",-1)),s("span",St,u((f=n.value)==null?void 0:f.statistics.accepted),1)]),s("div",Lt,[e[124]||(e[124]=s("span",{class:"label"},"Rejected",-1)),s("span",At,u((b=n.value)==null?void 0:b.statistics.rejected),1)]),s("div",Pt,[e[125]||(e[125]=s("span",{class:"label"},"Modified",-1)),s("span",Dt,u((h=n.value)==null?void 0:h.statistics.modified),1)])]),s("div",Rt,[s("div",Ot,[e[126]||(e[126]=s("label",null,"Your Name *",-1)),r(a(me),{modelValue:oe.value,"onUpdate:modelValue":e[33]||(e[33]=V=>oe.value=V),placeholder:"Enter your name...",class:"w-full"},null,8,["modelValue"])]),s("div",Vt,[e[127]||(e[127]=s("label",null,"Your Role *",-1)),r(a(Z),{modelValue:ue.value,"onUpdate:modelValue":e[34]||(e[34]=V=>ue.value=V),options:ns,optionLabel:"label",optionValue:"value",placeholder:"Select your role",class:"w-full"},null,8,["modelValue"])])]),s("div",Nt,[e[128]||(e[128]=s("label",null,"Comment (optional)",-1)),r(a(ge),{modelValue:re.value,"onUpdate:modelValue":e[35]||(e[35]=V=>re.value=V),rows:"2",class:"w-full",placeholder:"Add approval notes..."},null,8,["modelValue"])])])]}),_:1},8,["visible"]),r(a(Le),{visible:ne.value,"onUpdate:visible":e[42]||(e[42]=l=>ne.value=l),header:"Submit for Approval",modal:!0,style:{width:"500px"}},{footer:E(()=>[r(a(w),{label:"Cancel",severity:"secondary",onClick:e[41]||(e[41]=l=>ne.value=!1)}),r(a(w),{label:"Submit for Approval",icon:"pi pi-send",severity:"success",onClick:bs,loading:O.value},null,8,["loading"])]),default:E(()=>{var l,f,b,h,V;return[s("div",Tt,[r(a(be),{severity:"info",closable:!1},{default:E(()=>[...e[130]||(e[130]=[s("strong",null,"EU Compliance:",-1),S(" After submission, a different person (approver) must review and sign off on all curation decisions. ",-1)])]),_:1}),s("div",_t,[e[134]||(e[134]=s("h4",null,"Pre-Submission Checklist",-1)),s("div",Ft,[s("div",$t,[e[131]||(e[131]=s("i",{class:"pi pi-check-circle"},null,-1)),s("span",null,"All "+u((l=n.value)==null?void 0:l.statistics.total)+" items have been reviewed",1)]),s("div",{class:N(["check-item",{passed:(b=(f=D.value)==null?void 0:f.readiness)==null?void 0:b.allJustificationsComplete}])},[s("i",{class:N((V=(h=D.value)==null?void 0:h.readiness)!=null&&V.allJustificationsComplete?"pi pi-check-circle":"pi pi-exclamation-circle")},null,2),e[132]||(e[132]=s("span",null,"All required justifications are complete",-1))],2),s("div",{class:N(["check-item",{passed:ce.value===0}])},[s("i",{class:N(ce.value===0?"pi pi-check-circle":"pi pi-exclamation-circle")},null,2),e[133]||(e[133]=s("span",null,"All OR licenses have been resolved",-1))],2)])]),s("div",jt,[e[135]||(e[135]=s("label",null,"Submission Notes (optional)",-1)),r(a(ge),{modelValue:re.value,"onUpdate:modelValue":e[40]||(e[40]=U=>re.value=U),rows:"3",class:"w-full",placeholder:"Add any notes for the approver..."},null,8,["modelValue"])])])]}),_:1},8,["visible"]),r(a(Le),{visible:le.value,"onUpdate:visible":e[46]||(e[46]=l=>le.value=l),header:"Resolve OR License",modal:!0,style:{width:"600px"}},{footer:E(()=>[_.value?(t(),R(a(w),{key:0,label:"Back to List",severity:"secondary",onClick:e[44]||(e[44]=l=>_.value=null)})):y("",!0),r(a(w),{label:"Cancel",severity:"secondary",onClick:e[45]||(e[45]=l=>{le.value=!1,_.value=null})}),_.value?(t(),R(a(w),{key:1,label:"Confirm Choice",icon:"pi pi-check",severity:"success",onClick:Cs,loading:O.value,disabled:!W.value||!de.value},null,8,["loading","disabled"])):y("",!0)]),default:E(()=>[s("div",Ut,[r(a(be),{severity:"warn",closable:!1},{default:E(()=>[...e[136]||(e[136]=[s("strong",null,"Dual/Multi-License Resolution Required:",-1),S(" This dependency is available under multiple licenses. You must explicitly choose which license to use. ",-1)])]),_:1}),_.value?(t(),o("div",Jt,[s("div",Xt,[s("strong",null,u(_.value.dependencyName),1),s("span",Yt,"@"+u(_.value.dependencyVersion),1)]),s("div",qt,[e[137]||(e[137]=s("label",null,"License Expression",-1)),s("code",null,u(_.value.originalLicense),1)]),s("div",Ht,[e[138]||(e[138]=s("label",null,"Choose License *",-1)),s("div",zt,[(t(!0),o(B,null,Y(_.value.licenseOptions,l=>(t(),o("div",{key:l,class:N(["license-option",{selected:W.value===l}]),onClick:f=>W.value=l},[s("i",{class:N(W.value===l?"pi pi-check-circle":"pi pi-circle")},null,2),s("span",Kt,u(l),1)],10,Wt))),128))])]),s("div",Qt,[e[139]||(e[139]=s("label",null,"Reason for Choice *",-1)),r(a(ge),{modelValue:de.value,"onUpdate:modelValue":e[43]||(e[43]=l=>de.value=l),rows:"3",class:"w-full",placeholder:"Explain why you chose this license (e.g., 'MIT is more permissive and aligns with our distribution model')"},null,8,["modelValue"])])])):(t(),o("div",Mt,[s("h4",null,"Unresolved OR Licenses ("+u(ce.value)+")",1),(t(!0),o(B,null,Y(ee.value.filter(l=>!l.isResolved),l=>(t(),o("div",{key:l.dependencyId,class:"or-license-item"},[s("div",Bt,[s("strong",null,u(l.dependencyName),1),s("span",Gt,u(l.originalLicense),1)]),r(a(w),{label:"Resolve",icon:"pi pi-arrow-right",severity:"primary",size:"small",onClick:f=>Is(l)},null,8,["onClick"])]))),128))]))])]),_:1},8,["visible"])])}}}),oa=Us(Zt,[["__scopeId","data-v-df599ab5"]]);export{oa as default};
