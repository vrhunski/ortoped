import{B as G,q as L,c as v,k as u,b,a as n,A as y,E as O,p as Ve,D as $,U as oe,F as x,f as H,i as c,H as k,I as K,t as w,j as T,g as Pe,Q as Se,T as Ee,l as xe,d as Oe,M as $e,o as De,r as E,e as re,u as o,R as de,h as ce,V as Ne,G as He,_ as Ke}from"./index-DZl8BYRz.js";import{s as _e,a as F}from"./tabpanel.esm-Br8YNjIA.js";import{f as Re,s as V,c as ue,d as P,e as D,a as N,b as pe}from"./column.esm-Dm8uu_sK.js";import{a as Ue}from"./virtualscroller.esm-ZInRXuSR.js";import{s as Fe}from"./textarea.esm-CQxn7aVK.js";import{s as B}from"./inputswitch.esm-BpdHt3bf.js";var Be={root:"p-card p-component",header:"p-card-header",body:"p-card-body",caption:"p-card-caption",title:"p-card-title",subtitle:"p-card-subtitle",content:"p-card-content",footer:"p-card-footer"},je=G.extend({name:"card",classes:Be}),We={name:"BaseCard",extends:L,style:je},j={name:"Card",extends:We,inheritAttrs:!1};function Le(e,t,s,i,l,d){return u(),v("div",y({class:e.cx("root")},e.ptmi("root")),[e.$slots.header?(u(),v("div",y({key:0,class:e.cx("header")},e.ptm("header")),[O(e.$slots,"header")],16)):b("",!0),n("div",y({class:e.cx("body")},e.ptm("body")),[e.$slots.title||e.$slots.subtitle?(u(),v("div",y({key:0,class:e.cx("caption")},e.ptm("caption")),[e.$slots.title?(u(),v("div",y({key:0,class:e.cx("title")},e.ptm("title")),[O(e.$slots,"title")],16)):b("",!0),e.$slots.subtitle?(u(),v("div",y({key:1,class:e.cx("subtitle")},e.ptm("subtitle")),[O(e.$slots,"subtitle")],16)):b("",!0)],16)):b("",!0),n("div",y({class:e.cx("content")},e.ptm("content")),[O(e.$slots,"content")],16),e.$slots.footer?(u(),v("div",y({key:1,class:e.cx("footer")},e.ptm("footer")),[O(e.$slots,"footer")],16)):b("",!0)],16)],16)}j.render=Le;var ze={root:"p-accordion p-component",tab:{root:function(t){var s=t.instance,i=t.index;return["p-accordion-tab",{"p-accordion-tab-active":s.isTabActive(i)}]},header:function(t){var s=t.instance,i=t.tab,l=t.index;return["p-accordion-header",{"p-highlight":s.isTabActive(l),"p-disabled":s.getTabProp(i,"disabled")}]},headerAction:"p-accordion-header-link p-accordion-header-action",headerIcon:"p-accordion-toggle-icon",headerTitle:"p-accordion-header-text",toggleableContent:"p-toggleable-content",content:"p-accordion-content"}},Me=G.extend({name:"accordion",classes:ze}),Ge={name:"BaseAccordion",extends:L,props:{multiple:{type:Boolean,default:!1},activeIndex:{type:[Number,Array],default:null},lazy:{type:Boolean,default:!1},expandIcon:{type:String,default:void 0},collapseIcon:{type:String,default:void 0},tabindex:{type:Number,default:0},selectOnFocus:{type:Boolean,default:!1}},style:Me,provide:function(){return{$parentInstance:this}}},fe={name:"Accordion",extends:Ge,inheritAttrs:!1,emits:["update:activeIndex","tab-open","tab-close","tab-click"],data:function(){return{id:this.$attrs.id,d_activeIndex:this.activeIndex}},watch:{"$attrs.id":function(t){this.id=t||oe()},activeIndex:function(t){this.d_activeIndex=t}},mounted:function(){this.id=this.id||oe()},methods:{isAccordionTab:function(t){return t.type.name==="AccordionTab"},isTabActive:function(t){return this.multiple?this.d_activeIndex&&this.d_activeIndex.includes(t):this.d_activeIndex===t},getTabProp:function(t,s){return t.props?t.props[s]:void 0},getKey:function(t,s){return this.getTabProp(t,"header")||s},getTabHeaderActionId:function(t){return"".concat(this.id,"_").concat(t,"_header_action")},getTabContentId:function(t){return"".concat(this.id,"_").concat(t,"_content")},getTabPT:function(t,s,i){var l=this.tabs.length,d={props:t.props||{},parent:{instance:this,props:this.$props,state:this.$data},context:{index:i,count:l,first:i===0,last:i===l-1,active:this.isTabActive(i)}};return y(this.ptm("tab.".concat(s),{tab:d}),this.ptm("accordiontab.".concat(s),{accordiontab:d}),this.ptm("accordiontab.".concat(s),d),this.ptmo(this.getTabProp(t,"pt"),s,d))},onTabClick:function(t,s,i){this.changeActiveIndex(t,s,i),this.$emit("tab-click",{originalEvent:t,index:i})},onTabKeyDown:function(t,s,i){switch(t.code){case"ArrowDown":this.onTabArrowDownKey(t);break;case"ArrowUp":this.onTabArrowUpKey(t);break;case"Home":this.onTabHomeKey(t);break;case"End":this.onTabEndKey(t);break;case"Enter":case"NumpadEnter":case"Space":this.onTabEnterKey(t,s,i);break}},onTabArrowDownKey:function(t){var s=this.findNextHeaderAction(t.target.parentElement.parentElement);s?this.changeFocusedTab(t,s):this.onTabHomeKey(t),t.preventDefault()},onTabArrowUpKey:function(t){var s=this.findPrevHeaderAction(t.target.parentElement.parentElement);s?this.changeFocusedTab(t,s):this.onTabEndKey(t),t.preventDefault()},onTabHomeKey:function(t){var s=this.findFirstHeaderAction();this.changeFocusedTab(t,s),t.preventDefault()},onTabEndKey:function(t){var s=this.findLastHeaderAction();this.changeFocusedTab(t,s),t.preventDefault()},onTabEnterKey:function(t,s,i){this.changeActiveIndex(t,s,i),t.preventDefault()},findNextHeaderAction:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=s?t:t.nextElementSibling,l=$.findSingle(i,'[data-pc-section="header"]');return l?$.getAttribute(l,"data-p-disabled")?this.findNextHeaderAction(l.parentElement):$.findSingle(l,'[data-pc-section="headeraction"]'):null},findPrevHeaderAction:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=s?t:t.previousElementSibling,l=$.findSingle(i,'[data-pc-section="header"]');return l?$.getAttribute(l,"data-p-disabled")?this.findPrevHeaderAction(l.parentElement):$.findSingle(l,'[data-pc-section="headeraction"]'):null},findFirstHeaderAction:function(){return this.findNextHeaderAction(this.$el.firstElementChild,!0)},findLastHeaderAction:function(){return this.findPrevHeaderAction(this.$el.lastElementChild,!0)},changeActiveIndex:function(t,s,i){if(!this.getTabProp(s,"disabled")){var l=this.isTabActive(i),d=l?"tab-close":"tab-open";this.multiple?l?this.d_activeIndex=this.d_activeIndex.filter(function(p){return p!==i}):this.d_activeIndex?this.d_activeIndex.push(i):this.d_activeIndex=[i]:this.d_activeIndex=this.d_activeIndex===i?null:i,this.$emit("update:activeIndex",this.d_activeIndex),this.$emit(d,{originalEvent:t,index:i})}},changeFocusedTab:function(t,s){if(s&&($.focus(s),this.selectOnFocus)){var i=parseInt(s.parentElement.parentElement.dataset.pcIndex,10),l=this.tabs[i];this.changeActiveIndex(t,l,i)}}},computed:{tabs:function(){var t=this;return this.$slots.default().reduce(function(s,i){return t.isAccordionTab(i)?s.push(i):i.children&&i.children instanceof Array&&i.children.forEach(function(l){t.isAccordionTab(l)&&s.push(l)}),s},[])}},components:{ChevronDownIcon:Ue,ChevronRightIcon:Re},directives:{ripple:Ve}};function W(e){"@babel/helpers - typeof";return W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(e)}function ve(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),s.push.apply(s,i)}return s}function _(e){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?ve(Object(s),!0).forEach(function(i){Je(e,i,s[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ve(Object(s)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(s,i))})}return e}function Je(e,t,s){return t=Ye(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Ye(e){var t=qe(e,"string");return W(t)=="symbol"?t:String(t)}function qe(e,t){if(W(e)!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var i=s.call(e,t);if(W(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qe=["data-pc-index","data-p-active"],Xe=["data-p-highlight","data-p-disabled"],Ze=["id","tabindex","aria-disabled","aria-expanded","aria-controls","onClick","onKeydown"],et=["id","aria-labelledby"];function tt(e,t,s,i,l,d){return u(),v("div",y({class:e.cx("root")},e.ptmi("root")),[(u(!0),v(x,null,H(d.tabs,function(p,f){return u(),v("div",y({key:d.getKey(p,f),class:e.cx("tab.root",{tab:p,index:f})},d.getTabPT(p,"root",f),{"data-pc-name":"accordiontab","data-pc-index":f,"data-p-active":d.isTabActive(f)}),[n("div",y({style:d.getTabProp(p,"headerStyle"),class:[e.cx("tab.header",{tab:p,index:f}),d.getTabProp(p,"headerClass")]},_(_({},d.getTabProp(p,"headerProps")),d.getTabPT(p,"header",f)),{"data-p-highlight":d.isTabActive(f),"data-p-disabled":d.getTabProp(p,"disabled")}),[n("a",y({id:d.getTabHeaderActionId(f),class:e.cx("tab.headerAction"),tabindex:d.getTabProp(p,"disabled")?-1:e.tabindex,role:"button","aria-disabled":d.getTabProp(p,"disabled"),"aria-expanded":d.isTabActive(f),"aria-controls":d.getTabContentId(f),onClick:function(C){return d.onTabClick(C,p,f)},onKeydown:function(C){return d.onTabKeyDown(C,p,f)}},_(_({},d.getTabProp(p,"headeractionprops")),d.getTabPT(p,"headeraction",f))),[p.children&&p.children.headericon?(u(),k(K(p.children.headericon),{key:0,isTabActive:d.isTabActive(f),active:d.isTabActive(f),index:f},null,8,["isTabActive","active","index"])):d.isTabActive(f)?(u(),k(K(e.$slots.collapseicon?e.$slots.collapseicon:e.collapseIcon?"span":"ChevronDownIcon"),y({key:1,class:[e.cx("tab.headerIcon"),e.collapseIcon],"aria-hidden":"true"},d.getTabPT(p,"headericon",f)),null,16,["class"])):(u(),k(K(e.$slots.expandicon?e.$slots.expandicon:e.expandIcon?"span":"ChevronRightIcon"),y({key:2,class:[e.cx("tab.headerIcon"),e.expandIcon],"aria-hidden":"true"},d.getTabPT(p,"headericon",f)),null,16,["class"])),p.props&&p.props.header?(u(),v("span",y({key:3,class:e.cx("tab.headerTitle")},d.getTabPT(p,"headertitle",f)),w(p.props.header),17)):b("",!0),p.children&&p.children.header?(u(),k(K(p.children.header),{key:4})):b("",!0)],16,Ze)],16,Xe),c(Ee,y({name:"p-toggleable-content"},d.getTabPT(p,"transition",f)),{default:T(function(){return[!e.lazy||d.isTabActive(f)?Pe((u(),v("div",y({key:0,id:d.getTabContentId(f),style:d.getTabProp(p,"contentStyle"),class:[e.cx("tab.toggleableContent"),d.getTabProp(p,"contentClass")],role:"region","aria-labelledby":d.getTabHeaderActionId(f)},_(_({},d.getTabProp(p,"contentProps")),d.getTabPT(p,"toggleablecontent",f))),[n("div",y({class:e.cx("tab.content")},d.getTabPT(p,"content",f)),[(u(),k(K(p)))],16)],16,et)),[[Se,e.lazy?!0:d.isTabActive(f)]]):b("",!0)]}),_:2},1040)],16,Qe)}),128))],16)}fe.render=tt;var nt={},at={name:"BaseAccordionTab",extends:L,props:{header:null,headerStyle:null,headerClass:null,headerProps:null,headerActionProps:null,contentStyle:null,contentClass:null,contentProps:null,disabled:Boolean},style:nt,provide:function(){return{$parentInstance:this}}},me={name:"AccordionTab",extends:at,inheritAttrs:!1};function st(e,t,s,i,l,d){return O(e.$slots,"default")}me.render=st;var it={root:function(t){var s=t.props;return["p-chip p-component",{"p-chip-image":s.image!=null}]},icon:"p-chip-icon",label:"p-chip-text",removeIcon:"p-chip-remove-icon"},lt=G.extend({name:"chip",classes:it}),ot={name:"BaseChip",extends:L,props:{label:{type:String,default:null},icon:{type:String,default:null},image:{type:String,default:null},removable:{type:Boolean,default:!1},removeIcon:{type:String,default:void 0}},style:lt,provide:function(){return{$parentInstance:this}}},M={name:"Chip",extends:ot,inheritAttrs:!1,emits:["remove"],data:function(){return{visible:!0}},methods:{onKeydown:function(t){(t.key==="Enter"||t.key==="Backspace")&&this.close(t)},close:function(t){this.visible=!1,this.$emit("remove",t)}},components:{TimesCircleIcon:xe}},rt=["aria-label"],dt=["src"];function ct(e,t,s,i,l,d){return l.visible?(u(),v("div",y({key:0,class:e.cx("root"),"aria-label":e.label},e.ptmi("root")),[O(e.$slots,"default",{},function(){return[e.image?(u(),v("img",y({key:0,src:e.image},e.ptm("image")),null,16,dt)):e.$slots.icon?(u(),k(K(e.$slots.icon),y({key:1,class:e.cx("icon")},e.ptm("icon")),null,16,["class"])):e.icon?(u(),v("span",y({key:2,class:[e.cx("icon"),e.icon]},e.ptm("icon")),null,16)):b("",!0),e.label?(u(),v("div",y({key:3,class:e.cx("label")},e.ptm("label")),w(e.label),17)):b("",!0)]}),e.removable?O(e.$slots,"removeicon",{key:0,onClick:d.close,onKeydown:d.onKeydown,removeCallback:d.close,keydownCallback:d.onKeydown},function(){return[(u(),k(K(e.removeIcon?"span":"TimesCircleIcon"),y({tabindex:"0",class:[e.cx("removeIcon"),e.removeIcon],onClick:d.close,onKeydown:d.onKeydown},e.ptm("removeIcon")),null,16,["class","onClick","onKeydown"]))]}):b("",!0)],16,rt)):b("",!0)}M.render=ct;const ut={class:"policy-detail"},pt={key:0,class:"loading"},vt={class:"page-header"},ft={class:"breadcrumb"},mt={class:"title-row"},gt={key:0,class:"description"},ht={class:"overview-grid"},yt={class:"stat"},bt={class:"stat-value"},Tt={class:"stat"},At={class:"stat-value"},wt={class:"stat"},kt={class:"stat-value"},It={class:"stat"},Ct={class:"stat-value"},Vt={class:"section"},Pt={class:"settings-grid"},St={class:"setting-item"},Et={class:"setting-item"},xt={class:"setting-item"},Ot={class:"setting-item"},$t={class:"section"},Dt={class:"categories-summary"},Nt={class:"category-header"},Ht={key:0,class:"category-description"},Kt={class:"category-licenses"},_t={key:0,class:"no-categories"},Rt={key:0,class:"category-info"},Ut={class:"category-description"},Ft={class:"chips"},Bt={key:1,class:"no-licenses"},jt={key:1,class:"empty-section"},Wt={key:0,class:"exemptions-list"},Lt={key:1,class:"empty-section"},zt={key:0,class:"edit-form"},Mt={class:"section"},Gt={class:"form-row"},Jt={class:"form-group"},Yt={class:"form-row"},qt={class:"form-group"},Qt={class:"section"},Xt={class:"section-header"},Zt={class:"rule-header"},en={class:"rule-fields"},tn={class:"field"},nn={class:"field-row"},an={class:"field"},sn={class:"field"},ln={class:"field switch-field"},on={key:0,class:"section"},rn={class:"settings-form"},dn={class:"setting-row"},cn={class:"setting-row"},un={class:"setting-row"},pn={class:"setting-row"},vn={key:1,class:"section"},fn={class:"section-header"},mn={class:"exemption-fields"},gn={key:0,class:"no-items"},hn={class:"form-actions"},yn={key:2,class:"error-state"},bn=Oe({__name:"PolicyDetailView",setup(e){const t=Ne(),s=$e(),i=E(null),l=E(null),d=E(!0),p=E(!1),f=E(0),S=E(""),C=E(""),m=E(null),ge=[{label:"Error",value:"ERROR"},{label:"Warning",value:"WARNING"},{label:"Info",value:"INFO"}],he=[{label:"Allow",value:"ALLOW"},{label:"Deny",value:"DENY"},{label:"Review",value:"REVIEW"}];function z(g){var a,r,A;return{...g,settings:{...g.settings,failOn:{errors:!0,warnings:!1,...(a=g.settings)==null?void 0:a.failOn},aiSuggestions:{acceptHighConfidence:!0,treatMediumAsWarning:!0,rejectLowConfidence:!1,...(r=g.settings)==null?void 0:r.aiSuggestions},exemptions:((A=g.settings)==null?void 0:A.exemptions)||[]}}}async function J(){d.value=!0;try{const g=await ce.getPolicy(t.params.id);i.value=g.data;try{const a=JSON.parse(g.data.config);l.value=z(a),S.value=l.value.name||g.data.name,C.value=l.value.description||"",m.value=z(JSON.parse(JSON.stringify(a)))}catch(a){console.error("Failed to parse policy config",a),l.value=null}}catch(g){console.error("Failed to fetch policy",g),s.add({severity:"error",summary:"Error",detail:"Failed to fetch policy",life:3e3})}finally{d.value=!1}}function ye(g){switch(g){case"ERROR":return"danger";case"WARNING":return"warning";case"INFO":return"info";default:return"secondary"}}function be(g){switch(g){case"DENY":return"danger";case"WARN":return"warning";case"ALLOW":return"success";default:return"secondary"}}function Te(){if(!m.value)return;const g=`rule-${Date.now()}`;m.value.rules.push({id:g,name:"new-rule",description:"New rule description",severity:"WARNING",enabled:!0,scopes:[],action:"REVIEW"})}function Ae(g){m.value&&m.value.rules.splice(g,1)}function we(){m.value&&(m.value.settings.exemptions||(m.value.settings.exemptions=[]),m.value.settings.exemptions.push({dependency:"",reason:"",approvedBy:"",approvedDate:""}))}function ke(g){!m.value||!m.value.settings.exemptions||m.value.settings.exemptions.splice(g,1)}async function Ie(){if(!(!i.value||!m.value)){p.value=!0;try{m.value.name=S.value,m.value.description=C.value,await ce.updatePolicy(i.value.id,{name:S.value,config:JSON.stringify(m.value)}),s.add({severity:"success",summary:"Success",detail:"Policy saved successfully",life:3e3}),await J(),f.value=0}catch(g){console.error("Failed to save policy",g),s.add({severity:"error",summary:"Error",detail:"Failed to save policy",life:3e3})}finally{p.value=!1}}}function Ce(){var g;l.value&&(S.value=l.value.name||((g=i.value)==null?void 0:g.name)||"",C.value=l.value.description||"",m.value=z(JSON.parse(JSON.stringify(l.value))))}return De(J),(g,a)=>(u(),v("div",ut,[d.value?(u(),v("div",pt,[...a[7]||(a[7]=[n("i",{class:"pi pi-spin pi-spinner"},null,-1),re(" Loading policy... ",-1)])])):i.value&&l.value?(u(),v(x,{key:1},[n("header",vt,[n("div",null,[n("div",ft,[c(o(de),{to:"/policies"},{default:T(()=>[...a[8]||(a[8]=[re("Policies",-1)])]),_:1}),a[9]||(a[9]=n("i",{class:"pi pi-angle-right"},null,-1)),n("span",null,w(i.value.name),1)]),n("div",mt,[n("h1",null,w(i.value.name),1),i.value.isDefault?(u(),k(o(V),{key:0,value:"Default",severity:"info"})):b("",!0)]),l.value.description?(u(),v("p",gt,w(l.value.description),1)):b("",!0)])]),c(o(_e),{activeIndex:f.value,"onUpdate:activeIndex":a[6]||(a[6]=r=>f.value=r)},{default:T(()=>[c(o(F),{header:"Overview"},{default:T(()=>{var r,A,h,R,Y,q,Q,X,Z,ee,te,ne,ae,se;return[n("div",ht,[c(o(j),{class:"stat-card"},{content:T(()=>{var I;return[n("div",yt,[a[11]||(a[11]=n("i",{class:"pi pi-list"},null,-1)),n("div",null,[n("div",bt,w(((I=l.value.rules)==null?void 0:I.length)||0),1),a[10]||(a[10]=n("div",{class:"stat-label"},"Rules",-1))])])]}),_:1}),c(o(j),{class:"stat-card"},{content:T(()=>[n("div",Tt,[a[13]||(a[13]=n("i",{class:"pi pi-tags",style:{color:"#22c55e"}},null,-1)),n("div",null,[n("div",At,w(Object.keys(l.value.categories||{}).length),1),a[12]||(a[12]=n("div",{class:"stat-label"},"Categories",-1))])])]),_:1}),c(o(j),{class:"stat-card"},{content:T(()=>{var I,U;return[n("div",wt,[a[15]||(a[15]=n("i",{class:"pi pi-cog",style:{color:"#3b82f6"}},null,-1)),n("div",null,[n("div",kt,w(((U=(I=l.value.settings)==null?void 0:I.exemptions)==null?void 0:U.length)||0),1),a[14]||(a[14]=n("div",{class:"stat-label"},"Exemptions",-1))])])]}),_:1}),c(o(j),{class:"stat-card"},{content:T(()=>[n("div",It,[a[17]||(a[17]=n("i",{class:"pi pi-info-circle",style:{color:"#f59e0b"}},null,-1)),n("div",null,[n("div",Ct,w(l.value.version),1),a[16]||(a[16]=n("div",{class:"stat-label"},"Version",-1))])])]),_:1})]),n("div",Vt,[a[22]||(a[22]=n("h3",null,"Settings",-1)),n("div",Pt,[n("div",St,[a[18]||(a[18]=n("span",{class:"setting-label"},"Fail on Errors",-1)),c(o(V),{value:(A=(r=l.value.settings)==null?void 0:r.failOn)!=null&&A.errors?"Yes":"No",severity:(R=(h=l.value.settings)==null?void 0:h.failOn)!=null&&R.errors?"danger":"secondary"},null,8,["value","severity"])]),n("div",Et,[a[19]||(a[19]=n("span",{class:"setting-label"},"Fail on Warnings",-1)),c(o(V),{value:(q=(Y=l.value.settings)==null?void 0:Y.failOn)!=null&&q.warnings?"Yes":"No",severity:(X=(Q=l.value.settings)==null?void 0:Q.failOn)!=null&&X.warnings?"warning":"secondary"},null,8,["value","severity"])]),n("div",xt,[a[20]||(a[20]=n("span",{class:"setting-label"},"AI High Confidence",-1)),c(o(V),{value:(ee=(Z=l.value.settings)==null?void 0:Z.aiSuggestions)!=null&&ee.acceptHighConfidence?"Accept":"Review",severity:(ne=(te=l.value.settings)==null?void 0:te.aiSuggestions)!=null&&ne.acceptHighConfidence?"success":"secondary"},null,8,["value","severity"])]),n("div",Ot,[a[21]||(a[21]=n("span",{class:"setting-label"},"AI Medium Confidence",-1)),c(o(V),{value:(se=(ae=l.value.settings)==null?void 0:ae.aiSuggestions)!=null&&se.treatMediumAsWarning?"Warning":"Review",severity:"info"},null,8,["value"])])])]),n("div",$t,[a[23]||(a[23]=n("h3",null,"License Categories",-1)),n("div",Dt,[(u(!0),v(x,null,H(l.value.categories,(I,U)=>{var ie;return u(),v("div",{key:U,class:"category-summary"},[n("div",Nt,[n("h4",null,w(U),1),c(o(V),{value:((ie=I.licenses)==null?void 0:ie.length)||0,severity:"info"},null,8,["value"])]),I.description?(u(),v("p",Ht,w(I.description),1)):b("",!0),n("div",Kt,[(u(!0),v(x,null,H((I.licenses||[]).slice(0,5),le=>(u(),k(o(M),{key:le,label:le,size:"small"},null,8,["label"]))),128)),(I.licenses||[]).length>5?(u(),k(o(V),{key:0,value:`+${(I.licenses||[]).length-5} more`,severity:"secondary"},null,8,["value"])):b("",!0)])])}),128)),!l.value.categories||!Object.keys(l.value.categories).length?(u(),v("div",_t," No license categories defined ")):b("",!0)])])]}),_:1}),c(o(F),{header:"Rules"},{default:T(()=>[c(o(ue),{value:l.value.rules,stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:T(()=>[...a[24]||(a[24]=[n("div",{class:"empty-table"},"No rules configured",-1)])]),default:T(()=>[c(o(P),{field:"name",header:"Name",style:{"min-width":"150px"}},{body:T(({data:r})=>[n("strong",null,w(r.name),1)]),_:1}),c(o(P),{field:"description",header:"Description",style:{"min-width":"250px"}}),c(o(P),{field:"severity",header:"Severity",style:{width:"120px"}},{body:T(({data:r})=>[c(o(V),{value:r.severity,severity:ye(r.severity)},null,8,["value","severity"])]),_:1}),c(o(P),{field:"action",header:"Action",style:{width:"100px"}},{body:T(({data:r})=>[c(o(V),{value:r.action,severity:be(r.action)},null,8,["value","severity"])]),_:1}),c(o(P),{field:"enabled",header:"Enabled",style:{width:"100px"}},{body:T(({data:r})=>[n("i",{class:He(r.enabled?"pi pi-check-circle text-green":"pi pi-times-circle text-red")},null,2)]),_:1})]),_:1},8,["value"])]),_:1}),c(o(F),{header:"Categories"},{default:T(()=>[l.value.categories&&Object.keys(l.value.categories).length?(u(),k(o(fe),{key:0},{default:T(()=>[(u(!0),v(x,null,H(l.value.categories,(r,A)=>(u(),k(o(me),{key:A,header:A},{default:T(()=>{var h;return[r.description?(u(),v("div",Rt,[n("p",Ut,w(r.description),1)])):b("",!0),n("div",Ft,[(u(!0),v(x,null,H(r.licenses,R=>(u(),k(o(M),{key:R,label:R},null,8,["label"]))),128))]),(h=r.licenses)!=null&&h.length?b("",!0):(u(),v("div",Bt," No licenses in this category "))]}),_:2},1032,["header"]))),128))]),_:1})):(u(),v("div",jt,[...a[25]||(a[25]=[n("i",{class:"pi pi-folder-open"},null,-1),n("p",null,"No license categories defined",-1)])]))]),_:1}),c(o(F),{header:"Exemptions"},{default:T(()=>{var r,A;return[(A=(r=l.value.settings)==null?void 0:r.exemptions)!=null&&A.length?(u(),v("div",Wt,[c(o(ue),{value:l.value.settings.exemptions,stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{default:T(()=>[c(o(P),{field:"dependency",header:"Dependency Pattern",style:{"min-width":"200px"}}),c(o(P),{field:"reason",header:"Reason",style:{"min-width":"250px"}}),c(o(P),{field:"approvedBy",header:"Approved By",style:{"min-width":"150px"}}),c(o(P),{field:"approvedDate",header:"Approval Date",style:{"min-width":"120px"}})]),_:1},8,["value"])])):(u(),v("div",Lt,[...a[26]||(a[26]=[n("i",{class:"pi pi-shield"},null,-1),n("p",null,"No exemptions defined",-1),n("small",null,"Exemptions allow specific dependencies to bypass policy checks",-1)])]))]}),_:1}),c(o(F),{header:"Edit"},{default:T(()=>[m.value?(u(),v("div",zt,[n("div",Mt,[a[29]||(a[29]=n("h3",null,"Basic Information",-1)),n("div",Gt,[n("div",Jt,[a[27]||(a[27]=n("label",null,"Policy Name",-1)),c(o(D),{modelValue:S.value,"onUpdate:modelValue":a[0]||(a[0]=r=>S.value=r),class:"w-full"},null,8,["modelValue"])])]),n("div",Yt,[n("div",qt,[a[28]||(a[28]=n("label",null,"Description",-1)),c(o(Fe),{modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=r=>C.value=r),rows:"3",class:"w-full"},null,8,["modelValue"])])])]),n("div",Qt,[n("div",Xt,[a[30]||(a[30]=n("h3",null,"Rules",-1)),c(o(N),{label:"Add Rule",icon:"pi pi-plus",size:"small",onClick:Te})]),(u(!0),v(x,null,H(m.value.rules,(r,A)=>(u(),v("div",{key:A,class:"rule-editor"},[n("div",Zt,[c(o(D),{modelValue:r.name,"onUpdate:modelValue":h=>r.name=h,placeholder:"Rule name",class:"rule-name-input"},null,8,["modelValue","onUpdate:modelValue"]),c(o(N),{icon:"pi pi-trash",severity:"danger",text:"",size:"small",onClick:h=>Ae(A)},null,8,["onClick"])]),n("div",en,[n("div",tn,[a[31]||(a[31]=n("label",null,"Description",-1)),c(o(D),{modelValue:r.description,"onUpdate:modelValue":h=>r.description=h,class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),n("div",nn,[n("div",an,[a[32]||(a[32]=n("label",null,"Severity",-1)),c(o(pe),{modelValue:r.severity,"onUpdate:modelValue":h=>r.severity=h,options:ge,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),n("div",sn,[a[33]||(a[33]=n("label",null,"Action",-1)),c(o(pe),{modelValue:r.action,"onUpdate:modelValue":h=>r.action=h,options:he,optionLabel:"label",optionValue:"value",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),n("div",ln,[a[34]||(a[34]=n("label",null,"Enabled",-1)),c(o(B),{modelValue:r.enabled,"onUpdate:modelValue":h=>r.enabled=h},null,8,["modelValue","onUpdate:modelValue"])])])])]))),128))]),m.value.settings.failOn&&m.value.settings.aiSuggestions?(u(),v("div",on,[a[39]||(a[39]=n("h3",null,"Settings",-1)),n("div",rn,[n("div",dn,[a[35]||(a[35]=n("label",null,"Fail on Errors",-1)),c(o(B),{modelValue:m.value.settings.failOn.errors,"onUpdate:modelValue":a[2]||(a[2]=r=>m.value.settings.failOn.errors=r)},null,8,["modelValue"])]),n("div",cn,[a[36]||(a[36]=n("label",null,"Fail on Warnings",-1)),c(o(B),{modelValue:m.value.settings.failOn.warnings,"onUpdate:modelValue":a[3]||(a[3]=r=>m.value.settings.failOn.warnings=r)},null,8,["modelValue"])]),n("div",un,[a[37]||(a[37]=n("label",null,"Accept High Confidence AI",-1)),c(o(B),{modelValue:m.value.settings.aiSuggestions.acceptHighConfidence,"onUpdate:modelValue":a[4]||(a[4]=r=>m.value.settings.aiSuggestions.acceptHighConfidence=r)},null,8,["modelValue"])]),n("div",pn,[a[38]||(a[38]=n("label",null,"Treat Medium AI as Warning",-1)),c(o(B),{modelValue:m.value.settings.aiSuggestions.treatMediumAsWarning,"onUpdate:modelValue":a[5]||(a[5]=r=>m.value.settings.aiSuggestions.treatMediumAsWarning=r)},null,8,["modelValue"])])])])):b("",!0),m.value.settings.exemptions?(u(),v("div",vn,[n("div",fn,[a[40]||(a[40]=n("h3",null,"Exemptions",-1)),c(o(N),{label:"Add Exemption",icon:"pi pi-plus",size:"small",onClick:we})]),(u(!0),v(x,null,H(m.value.settings.exemptions,(r,A)=>(u(),v("div",{key:A,class:"exemption-item"},[n("div",mn,[c(o(D),{modelValue:r.dependency,"onUpdate:modelValue":h=>r.dependency=h,placeholder:"Dependency pattern (e.g., npm::package:* )",class:"w-full mb-2"},null,8,["modelValue","onUpdate:modelValue"]),c(o(D),{modelValue:r.reason,"onUpdate:modelValue":h=>r.reason=h,placeholder:"Reason for exemption",class:"w-full mb-2"},null,8,["modelValue","onUpdate:modelValue"]),c(o(D),{modelValue:r.approvedBy,"onUpdate:modelValue":h=>r.approvedBy=h,placeholder:"Approved by",class:"w-full mb-2"},null,8,["modelValue","onUpdate:modelValue"]),c(o(D),{modelValue:r.approvedDate,"onUpdate:modelValue":h=>r.approvedDate=h,placeholder:"Approval date",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),c(o(N),{icon:"pi pi-trash",severity:"danger",text:"",size:"small",onClick:h=>ke(A)},null,8,["onClick"])]))),128)),m.value.settings.exemptions.length?b("",!0):(u(),v("div",gn,' No exemptions. Click "Add Exemption" to add one. '))])):b("",!0),n("div",hn,[c(o(N),{label:"Reset",severity:"secondary",onClick:Ce}),c(o(N),{label:"Save Changes",icon:"pi pi-check",onClick:Ie,loading:p.value},null,8,["loading"])])])):b("",!0)]),_:1})]),_:1},8,["activeIndex"])],64)):(u(),v("div",yn,[a[41]||(a[41]=n("i",{class:"pi pi-exclamation-triangle"},null,-1)),a[42]||(a[42]=n("h3",null,"Policy Not Found",-1)),a[43]||(a[43]=n("p",null,"The requested policy could not be found or has an invalid configuration.",-1)),c(o(de),{to:"/policies"},{default:T(()=>[c(o(N),{label:"Back to Policies"})]),_:1})]))]))}}),Vn=Ke(bn,[["__scopeId","data-v-4a1c9682"]]);export{Vn as default};
