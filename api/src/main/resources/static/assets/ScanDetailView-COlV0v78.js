import{d as Ce,g as Se,Q as Be,c as l,a as s,t as a,b as p,e as m,H as G,i as y,u as d,F as I,f as V,k as n,_ as ke,M as We,o as je,r as k,j as L,R as te,G as O,S as de,v as He,h as x,V as Ge,w as Ke,W as we,X as qe}from"./index-DZl8BYRz.js";import{s as E,a as U,b as Xe,c as Ye,d as H}from"./column.esm-Dm8uu_sK.js";import"./virtualscroller.esm-ZInRXuSR.js";const ze={class:"license-popup"},Je={class:"popup-header"},Ze={key:0},Qe={key:1},es={class:"popup-content"},ss={key:0,class:"license-loading"},ts={key:1,class:"license-error"},is={key:2,class:"license-details"},ns={class:"license-meta"},ls={class:"meta-item"},os={class:"license-id"},as={class:"meta-badges"},cs={key:0,class:"see-also-section"},rs={class:"see-also-list"},ds=["href"],us={key:1,class:"header-section"},ps={class:"license-header"},vs={key:2,class:"license-text-section"},ys={class:"license-text"},gs=Ce({__name:"LicenseDetailPopup",props:{visible:{type:Boolean},license:{},loading:{type:Boolean},error:{}},emits:["close"],setup(_,{emit:P}){const ie=P;return(R,v)=>Se((n(),l("div",ze,[s("div",Je,[_.license?(n(),l("h4",Ze,a(_.license.name),1)):(n(),l("h4",Qe,"License Details")),s("button",{class:"close-btn",onClick:v[0]||(v[0]=T=>ie("close")),"aria-label":"Close"},[...v[1]||(v[1]=[s("i",{class:"pi pi-times"},null,-1)])])]),s("div",es,[_.loading?(n(),l("div",ss,[...v[2]||(v[2]=[s("i",{class:"pi pi-spin pi-spinner"},null,-1),m(" Loading license details... ",-1)])])):_.error?(n(),l("div",ts,[v[3]||(v[3]=s("i",{class:"pi pi-exclamation-triangle"},null,-1)),m(" "+a(_.error),1)])):_.license?(n(),l("div",is,[s("div",ns,[s("div",ls,[v[4]||(v[4]=s("span",{class:"meta-label"},"License ID",-1)),s("code",os,a(_.license.licenseId),1)]),s("div",as,[_.license.isOsiApproved?(n(),G(d(E),{key:0,value:"OSI Approved",severity:"success"})):p("",!0),_.license.isFsfLibre?(n(),G(d(E),{key:1,value:"FSF Libre",severity:"info"})):p("",!0),_.license.isDeprecated?(n(),G(d(E),{key:2,value:"Deprecated",severity:"danger"})):p("",!0),y(d(E),{value:_.license.category,severity:"secondary"},null,8,["value"])])]),_.license.seeAlso.length>0?(n(),l("div",cs,[v[6]||(v[6]=s("strong",null,"References:",-1)),s("ul",rs,[(n(!0),l(I,null,V(_.license.seeAlso,T=>(n(),l("li",{key:T},[s("a",{href:T,target:"_blank",rel:"noopener noreferrer"},[v[5]||(v[5]=s("i",{class:"pi pi-external-link"},null,-1)),m(" "+a(T),1)],8,ds)]))),128))])])):p("",!0),_.license.standardHeader?(n(),l("div",us,[v[7]||(v[7]=s("strong",null,"Standard License Header:",-1)),s("pre",ps,a(_.license.standardHeader),1)])):p("",!0),_.license.licenseText?(n(),l("div",vs,[v[8]||(v[8]=s("strong",null,"Full License Text:",-1)),s("pre",ys,a(_.license.licenseText),1)])):p("",!0)])):p("",!0)])],512)),[[Be,_.visible]])}}),ms=ke(gs,[["__scopeId","data-v-0a1bb5b7"]]),fs={class:"scan-detail"},hs={key:0,class:"loading"},_s={class:"page-header"},ws={class:"breadcrumb"},Cs={class:"scan-meta"},Ss={key:0,class:"header-actions"},ks={key:0,class:"section scanning-state"},Es={key:1,class:"section error-state"},Rs={class:"compliance-icon"},bs={class:"compliance-info"},Ls={class:"compliance-stats"},xs={key:0,class:"stat"},Is={key:1,class:"stat"},Os={key:2,class:"stat"},Ps={key:3,class:"stat"},Ts={class:"section policy-section"},Ds={class:"policy-controls"},Us={class:"policy-selector"},Ms={key:0,class:"no-policies"},As={class:"section curation-section"},Ns={key:0,class:"curation-status"},Vs={class:"curation-info"},Fs={class:"curation-stats"},$s={class:"stat-item accepted"},Bs={class:"stat-item rejected"},Ws={class:"stat-item modified"},js={key:1,class:"no-curation"},Hs={key:1,class:"section violations-section"},Gs={class:"section-header"},Ks={key:0,class:"enhanced-badge"},qs={class:"violations-list"},Xs=["onClick"],Ys={class:"violation-main"},zs={class:"dependency-name"},Js={class:"license-badge"},Zs={class:"rule-name"},Qs={class:"violation-actions"},et={class:"violation-message"},st={key:0,class:"violation-details"},tt={class:"explanations-section"},it={class:"explanation-header"},nt={class:"explanation-summary"},lt={class:"explanation-details"},ot={key:0,class:"explanation-context"},at={key:0,class:"context-tag"},ct={key:1,class:"context-tag"},rt={key:2,class:"context-tag"},dt={class:"resolutions-section"},ut={class:"resolution-header"},pt={class:"resolution-description"},vt={key:0,class:"resolution-steps"},yt={key:1,class:"resolution-tradeoffs"},gt={key:2,class:"resolution-alternatives"},mt={class:"alternatives-list"},ft={class:"alt-license"},ht={class:"alt-reason"},_t={key:1,class:"no-enhanced-data"},wt={key:0,class:"suggestion"},Ct={class:"section"},St={class:"section-header"},kt={class:"header-right"},Et={key:0,class:"curation-summary"},Rt={key:0,class:"curation-stat must-curate"},bt={key:1,class:"curation-stat review"},Lt={key:2,class:"curation-stat safe"},xt={class:"curation-stat resolved"},It={class:"curation-cell"},Ot={class:"dep-id"},Pt={key:0,class:"curation-reason"},Tt={class:"license-cell"},Dt={key:0,class:"detected-licenses"},Ut={key:0,class:"ai-suggestion"},Mt={class:"suggested-license"},At={class:"reasoning"},Nt={key:1,class:"no-suggestion"},Vt=["onMouseenter","onFocus","onKeydown","tabindex","title","aria-label"],Ft={class:"spdx-license-info"},$t={class:"suggested-license"},Bt={key:0,class:"pi pi-info-circle spdx-info-icon"},Wt={class:"spdx-status"},jt={key:0,class:"spdx-suggestion-label"},Ht={key:1,class:"no-spdx"},Gt=Ce({__name:"ScanDetailView",setup(_){const P=Ge(),ie=qe(),R=We(),v=k(null),T=k([]),ne=k(!0),ue=k(0),z=k(""),F=k([]),$=k(null),K=k(!1),g=k(null),le=k(!1),J=k(null),Z=k(!1),Q=k(null),Ee=k(null),C=k(null),B=k(!1),M=k(new Set),ee=k(null);function Re(i){M.value.has(i)?M.value.delete(i):M.value.add(i),M.value=new Set(M.value)}function se(i){var e,t;return(t=(e=g.value)==null?void 0:e.enhancedViolations)==null?void 0:t.find(o=>o.dependencyName===i)}function be(i){return{WHY_PROHIBITED:"pi-ban",COPYLEFT_RISK:"pi-shield",COMPATIBILITY_ISSUE:"pi-link",OBLIGATION_CONCERN:"pi-file",RISK_LEVEL:"pi-chart-line",PROPAGATION_RISK:"pi-sitemap",USE_CASE_MISMATCH:"pi-crosshairs"}[i]||"pi-info-circle"}function Le(i){return{TRIVIAL:"success",LOW:"success",MEDIUM:"warning",HIGH:"danger",SIGNIFICANT:"danger"}[i]||"info"}const pe=["GPL","AGPL","LGPL","SSPL","EPL","MPL","CDDL","CPL","OSL"],oe=["MIT","BSD","ISC","Apache","Unlicense","CC0","WTFPL","0BSD","Zlib"],xe=["BitTorrent-1.0","Zlib","blessing"];function D(i){var X,Y;const e=[],t=i.concludedLicense||"",o=i.declaredLicenses||[],c=i.detectedLicenses||[],u=t.toUpperCase(),r=((Y=(X=g.value)==null?void 0:X.violations)==null?void 0:Y.some(S=>S.dependency===i.name))||!1;if(u==="UNKNOWN"||u==="NOASSERTION"||!t)return e.push("Unknown or missing license"),{category:"MUST_CURATE",priority:0,reasons:e,action:"Manual review required - determine actual license"};if(pe.some(S=>u.includes(S)||c.some(b=>b.toUpperCase().includes(S))))return e.push("Copyleft license detected - distribution obligations may apply"),{category:"MUST_CURATE",priority:0,reasons:e,action:"Verify copyleft obligations and document decision"};const h=new Set(o.map(S=>S.toUpperCase())),w=new Set(c.map(S=>S.toUpperCase())),q=c.length>0&&![...w].every(S=>h.has(S))&&![...h].every(S=>w.has(S));return q&&!ve(o,c)?(e.push("Declared licenses differ from detected licenses"),{category:"MUST_CURATE",priority:0,reasons:e,action:"Review source and determine correct license"}):(t.includes(" OR ")||t.includes(" AND "))&&!i.isResolved&&(pe.some(b=>u.includes(b))||t.includes(" AND "))?(e.push("License expression requires explicit choice"),{category:"MUST_CURATE",priority:0,reasons:e,action:"Choose specific license from expression"}):r?(e.push("Policy violation flagged"),{category:"MUST_CURATE",priority:0,reasons:e,action:"Address policy violation"}):t.includes(" OR ")&&!i.isResolved?(e.push("OR license expression - consider documenting choice"),{category:"REVIEW_RECOMMENDED",priority:1,reasons:e,action:"Document which license applies to your use case"}):!i.isResolved&&i.aiSuggestion?(e.push("Has AI suggestion awaiting review"),{category:"REVIEW_RECOMMENDED",priority:1,reasons:e,action:"Review and accept/reject AI suggestion"}):c.some(S=>xe.some(b=>S.toUpperCase().includes(b.toUpperCase())))&&Ie(o)?(e.push("Known scanner false positive with permissive declared license"),{category:"SAFE_TO_IGNORE",priority:2,reasons:e,action:"Can safely accept declared license"}):q&&ve(o,c)?(e.push("Permissive vs permissive conflict - obligations equivalent"),{category:"SAFE_TO_IGNORE",priority:2,reasons:e,action:"Accept declared license - no legal risk"}):i.isResolved?{category:"RESOLVED",priority:3,reasons:["License resolved"],action:"No action needed"}:{category:"REVIEW_RECOMMENDED",priority:1,reasons:["Unresolved - needs review"],action:"Review and curate license"}}function ve(i,e){const t=i.every(c=>oe.some(u=>c.toUpperCase().includes(u.toUpperCase()))),o=e.every(c=>oe.some(u=>c.toUpperCase().includes(u.toUpperCase())));return t&&o}function Ie(i){return i.length>0&&i.every(e=>oe.some(t=>e.toUpperCase().includes(t.toUpperCase())))}function ye(i){switch(i){case"MUST_CURATE":return{label:"Must Curate",severity:"danger",icon:"pi-exclamation-triangle"};case"REVIEW_RECOMMENDED":return{label:"Review",severity:"warning",icon:"pi-eye"};case"SAFE_TO_IGNORE":return{label:"Safe",severity:"success",icon:"pi-check"};case"RESOLVED":return{label:"Resolved",severity:"info",icon:"pi-check-circle"};default:return{label:"Unknown",severity:"secondary",icon:"pi-question"}}}async function ge(i,e,t){if(v.value){ee.value=i;try{if(!C.value){const c=await x.startCurationSession(v.value.id);C.value=c.data,R.add({severity:"success",summary:"Curation Started",detail:"New curation session created",life:2e3})}let o=t;if(!o){const c=T.value.find(u=>u.name===i||u.name.toLowerCase()===i.toLowerCase());c&&(o=c.id)}ie.push({path:`/curations/${v.value.id}`,query:{search:i,highlight:i,...o&&{dependencyId:o}}})}catch(o){console.error("Failed to add to curation",o),R.add({severity:"error",summary:"Error",detail:"Failed to start curation session",life:3e3})}finally{ee.value=null}}}const me=de(()=>{let i=[...T.value];if(z.value){const e=z.value.toLowerCase();i=i.filter(t=>{var o;return t.name.toLowerCase().includes(e)||((o=t.concludedLicense)==null?void 0:o.toLowerCase().includes(e))})}return i.sort((e,t)=>{const o=D(e),c=D(t);return o.priority!==c.priority?o.priority-c.priority:e.aiSuggestion&&!t.aiSuggestion?-1:!e.aiSuggestion&&t.aiSuggestion?1:e.name.localeCompare(t.name)}),i}),W=de(()=>{const i={mustCurate:0,reviewRecommended:0,safeToIgnore:0,resolved:0};return T.value.forEach(e=>{switch(D(e).category){case"MUST_CURATE":i.mustCurate++;break;case"REVIEW_RECOMMENDED":i.reviewRecommended++;break;case"SAFE_TO_IGNORE":i.safeToIgnore++;break;case"RESOLVED":i.resolved++;break}}),i}),Oe=de(()=>F.value.map(i=>({label:i.name+(i.isDefault?" (Default)":""),value:i.id})));async function Pe(){ne.value=!0;try{const[i,e]=await Promise.all([x.getScan(P.params.id),x.listPolicies(1,100)]);v.value=i.data,F.value=e.data.policies;const t=F.value.find(o=>o.isDefault);if(t?$.value=t.id:F.value.length>0&&($.value=F.value[0].id),v.value.status==="complete"){const o=[];let c=1;const u=100;let r=!0;for(;r;){const f=await x.getDependencies(P.params.id,c,u);o.push(...f.data.dependencies),ue.value=f.data.total,o.length>=f.data.total?r=!1:c++}T.value=o,await Promise.all([Ue(),Me()])}}catch(i){console.error("Failed to fetch scan data",i),R.add({severity:"error",summary:"Error",detail:"Failed to fetch scan data",life:3e3})}finally{ne.value=!1}}async function Te(){var i,e;if(!(!$.value||!v.value)){K.value=!0,g.value=null;try{const o=(await x.evaluatePolicy(v.value.id,$.value)).data,c=JSON.parse(o.report);g.value={policyId:o.policyId,policyName:c.policyName,scanId:o.scanId,passed:o.passed,errorCount:o.errorCount,warningCount:o.warningCount,infoCount:((i=c.summary)==null?void 0:i.infoCount)||0,violations:((e=c.violations)==null?void 0:e.map(u=>({severity:u.severity,rule:u.ruleName,message:u.message,dependency:u.dependencyName,license:u.license,suggestion:u.aiSuggestion})))||[],enhancedViolations:c.enhancedViolations,evaluatedAt:o.createdAt},g.value.passed?R.add({severity:"success",summary:"Policy Check Passed",detail:"No violations found",life:3e3}):R.add({severity:"warn",summary:"Policy Check Failed",detail:`Found ${g.value.errorCount} errors, ${g.value.warningCount} warnings`,life:5e3})}catch(t){console.error("Failed to evaluate policy",t),R.add({severity:"error",summary:"Error",detail:"Failed to run policy check",life:3e3})}finally{K.value=!1}}}async function De(i){try{const e=await x.generateSbom(P.params.id,i),t=new Blob([e.data.content],{type:"application/json"}),o=URL.createObjectURL(t),c=document.createElement("a");c.href=o,c.download=e.data.filename,c.click(),URL.revokeObjectURL(o)}catch(e){console.error("Failed to download SBOM",e),R.add({severity:"error",summary:"Error",detail:"Failed to download SBOM",life:3e3})}}async function Ue(){try{const i=await x.getReportSummary(P.params.id);Ee.value=i.data}catch(i){console.error("Failed to fetch report summary",i)}}async function Me(){try{const i=await x.getCurationSessionByScan(P.params.id);C.value=i.data}catch{C.value=null}}async function fe(i){B.value=!0;try{const e=await x.generateReport(P.params.id,{format:i,includePolicy:!0,includeCuration:!0,includeAuditTrail:!0,includeDependencyDetails:!0}),t=e.data.content,o=e.data.filename,c=i==="html"?"text/html":"application/json",u=new Blob([t],{type:c}),r=URL.createObjectURL(u),f=document.createElement("a");f.href=r,f.download=o,f.click(),URL.revokeObjectURL(r),R.add({severity:"success",summary:"Success",detail:`Report downloaded as ${i.toUpperCase()}`,life:2e3})}catch(e){console.error("Failed to download report",e),R.add({severity:"error",summary:"Error",detail:"Failed to generate report",life:3e3})}finally{B.value=!1}}async function Ae(){B.value=!0;try{const i=await x.downloadOrtExport(P.params.id),e=i.data.content,t=i.data.filename,o=new Blob([e],{type:"application/json"}),c=URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download=t,u.click(),URL.revokeObjectURL(c),R.add({severity:"success",summary:"Success",detail:"ORT export downloaded",life:2e3})}catch(i){console.error("Failed to download ORT export",i),R.add({severity:"error",summary:"Error",detail:"Failed to generate ORT export",life:3e3})}finally{B.value=!1}}function Ne(i){switch(i){case"HIGH":return"confidence-high";case"MEDIUM":return"confidence-medium";default:return"confidence-low"}}function Ve(i){switch(i){case"ERROR":return"danger";case"WARNING":return"warning";case"INFO":return"info";default:return"secondary"}}async function Fe(i){Z.value=!0,Q.value=null,J.value=null;try{const e=await x.getSpdxLicense(i);J.value=e.data}catch(e){console.error("Failed to fetch license details",e),Q.value="Failed to load license details"}finally{Z.value=!1}}function ae(i,e){e&&(j&&(clearTimeout(j),j=null),le.value=!0,Fe(e),setTimeout(()=>{const t=document.querySelector(".license-popup");if(t){const o=t.getBoundingClientRect(),c=window.innerWidth,u=window.innerHeight,r="clientX"in i?i.clientX:c/2,f="clientY"in i?i.clientY:u/2;let h=r+15,w=f+15;h+o.width>c&&(h=r-o.width-15),w+o.height>u&&(w=f-o.height-15),h=Math.max(10,Math.min(h,c-o.width-10)),w=Math.max(10,Math.min(w,u-o.height-10)),t.style.left=h+"px",t.style.top=w+"px",t.style.opacity="1",t.style.transform="scale(1)"}},50))}let j=null;function ce(){j=setTimeout(()=>{_e()},300)}function $e(){j&&(clearTimeout(j),j=null)}function he(){_e()}function _e(){const i=document.querySelector(".license-popup");i&&(i.style.opacity="0",i.style.transform="scale(0.95)"),setTimeout(()=>{le.value=!1,setTimeout(()=>{J.value=null,Q.value=null,Z.value=!1},200)},150)}return je(Pe),(i,e)=>(n(),l("div",fs,[ne.value?(n(),l("div",hs,[...e[5]||(e[5]=[s("i",{class:"pi pi-spin pi-spinner"},null,-1),m(" Loading... ",-1)])])):v.value?(n(),l(I,{key:1},[s("header",_s,[s("div",null,[s("div",ws,[y(d(te),{to:"/scans"},{default:L(()=>[...e[6]||(e[6]=[m("Scans",-1)])]),_:1}),e[7]||(e[7]=s("i",{class:"pi pi-angle-right"},null,-1)),e[8]||(e[8]=s("span",null,"Scan Details",-1))]),e[9]||(e[9]=s("h1",null,"Scan Details",-1)),s("div",Cs,[s("span",{class:O(["status-badge",v.value.status==="complete"?"status-success":"status-warning"])},a(v.value.status),3),s("span",null,"Created: "+a(new Date(v.value.createdAt).toLocaleString()),1)])]),v.value.status==="complete"?(n(),l("div",Ss,[y(d(U),{label:"Export SBOM",icon:"pi pi-download",severity:"secondary",onClick:e[0]||(e[0]=t=>De("cyclonedx-json"))}),y(d(U),{label:"Report (JSON)",icon:"pi pi-file",severity:"secondary",onClick:e[1]||(e[1]=t=>fe("json")),loading:B.value},null,8,["loading"]),y(d(U),{label:"Report (HTML)",icon:"pi pi-file",severity:"secondary",onClick:e[2]||(e[2]=t=>fe("html")),loading:B.value},null,8,["loading"]),y(d(U),{label:"ORT Export",icon:"pi pi-share-alt",severity:"secondary",onClick:Ae,loading:B.value,title:"Export in ORT Evaluator format"},null,8,["loading"])])):p("",!0)]),v.value.status==="scanning"?(n(),l("div",ks,[...e[10]||(e[10]=[s("i",{class:"pi pi-spin pi-spinner"},null,-1),s("h3",null,"Scan in Progress",-1),s("p",null,"Analyzing dependencies and resolving licenses...",-1)])])):v.value.status==="failed"?(n(),l("div",Es,[e[11]||(e[11]=s("i",{class:"pi pi-times-circle"},null,-1)),e[12]||(e[12]=s("h3",null,"Scan Failed",-1)),s("p",null,a(v.value.errorMessage||"An unknown error occurred"),1)])):(n(),l(I,{key:2},[g.value?(n(),l("div",{key:0,class:O(["compliance-banner",g.value.passed?"compliance-passed":"compliance-failed"])},[s("div",Rs,[s("i",{class:O(g.value.passed?"pi pi-check-circle":"pi pi-times-circle")},null,2)]),s("div",bs,[s("h3",null,a(g.value.passed?"Policy Check Passed":"Policy Check Failed"),1),s("p",null,"Policy: "+a(g.value.policyName),1)]),s("div",Ls,[g.value.errorCount>0?(n(),l("div",xs,[y(d(E),{value:g.value.errorCount,severity:"danger"},null,8,["value"]),e[13]||(e[13]=s("span",null,"Errors",-1))])):p("",!0),g.value.warningCount>0?(n(),l("div",Is,[y(d(E),{value:g.value.warningCount,severity:"warning"},null,8,["value"]),e[14]||(e[14]=s("span",null,"Warnings",-1))])):p("",!0),g.value.infoCount>0?(n(),l("div",Os,[y(d(E),{value:g.value.infoCount,severity:"info"},null,8,["value"]),e[15]||(e[15]=s("span",null,"Info",-1))])):p("",!0),g.value.passed?(n(),l("div",Ps,[y(d(E),{value:"0",severity:"success"}),e[16]||(e[16]=s("span",null,"Violations",-1))])):p("",!0)])],2)):p("",!0),s("div",Ts,[e[21]||(e[21]=s("div",{class:"section-header"},[s("h2",null,[s("i",{class:"pi pi-shield"}),m(" Policy Compliance")])],-1)),s("div",Ds,[s("div",Us,[e[17]||(e[17]=s("label",null,"Select Policy:",-1)),y(d(Xe),{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=t=>$.value=t),options:Oe.value,optionLabel:"label",optionValue:"value",placeholder:"Select a policy",class:"policy-dropdown",disabled:K.value||F.value.length===0},null,8,["modelValue","options","disabled"])]),y(d(U),{label:"Run Policy Check",icon:"pi pi-play",onClick:Te,loading:K.value,disabled:!$.value||K.value},null,8,["loading","disabled"])]),F.value.length===0?(n(),l("p",Ms,[e[19]||(e[19]=m(" No policies available. ",-1)),y(d(te),{to:"/policies"},{default:L(()=>[...e[18]||(e[18]=[m("Create a policy",-1)])]),_:1}),e[20]||(e[20]=m(" to run compliance checks. ",-1))])):p("",!0)]),s("div",As,[e[26]||(e[26]=s("div",{class:"section-header"},[s("h2",null,[s("i",{class:"pi pi-check-square"}),m(" License Curation")])],-1)),C.value?(n(),l("div",Ns,[s("div",Vs,[y(d(E),{value:C.value.status,severity:C.value.status==="APPROVED"?"success":C.value.status==="IN_PROGRESS"?"warning":"info"},null,8,["value","severity"]),s("div",Fs,[s("span",null,[s("strong",null,a(C.value.statistics.total-C.value.statistics.pending),1),m(" / "+a(C.value.statistics.total)+" reviewed",1)]),s("span",$s,[e[22]||(e[22]=s("i",{class:"pi pi-check"},null,-1)),m(" "+a(C.value.statistics.accepted)+" accepted",1)]),s("span",Bs,[e[23]||(e[23]=s("i",{class:"pi pi-times"},null,-1)),m(" "+a(C.value.statistics.rejected)+" rejected",1)]),s("span",Ws,[e[24]||(e[24]=s("i",{class:"pi pi-pencil"},null,-1)),m(" "+a(C.value.statistics.modified)+" modified",1)])])]),y(d(te),{to:`/curations/${C.value.scanId}`},{default:L(()=>[y(d(U),{label:C.value.status==="APPROVED"?"View Curation":"Continue Curation",icon:C.value.status==="APPROVED"?"pi pi-eye":"pi pi-arrow-right",severity:C.value.status==="APPROVED"?"secondary":"primary"},null,8,["label","icon","severity"])]),_:1},8,["to"])])):(n(),l("div",js,[e[25]||(e[25]=s("p",null,"No curation session started for this scan. Start one to review and approve AI-suggested licenses.",-1)),y(d(te),{to:"/curations"},{default:L(()=>[y(d(U),{label:"Start Curation",icon:"pi pi-plus"})]),_:1})]))]),g.value&&g.value.violations.length>0?(n(),l("div",Hs,[s("div",Gs,[s("h2",null,[e[27]||(e[27]=s("i",{class:"pi pi-exclamation-triangle"},null,-1)),m(" Violations ("+a(g.value.violations.length)+")",1)]),g.value.enhancedViolations?(n(),l("span",Ks,[...e[28]||(e[28]=[s("i",{class:"pi pi-sparkles"},null,-1),m(" Enhanced Explanations ",-1)])])):p("",!0)]),s("div",qs,[(n(!0),l(I,null,V(g.value.violations,(t,o)=>{var c,u;return n(),l("div",{key:o,class:O(["violation-card",{expanded:M.value.has(o)}])},[s("div",{class:"violation-header",onClick:r=>Re(o)},[s("div",Ys,[y(d(E),{value:t.severity,severity:Ve(t.severity)},null,8,["value","severity"]),s("code",zs,a(t.dependency),1),s("span",Js,a(t.license||"Unknown"),1),s("span",Zs,a(t.rule),1)]),s("div",Qs,[y(d(U),{label:"Review in Curation",icon:"pi pi-pencil",severity:"secondary",size:"small",onClick:Ke(r=>{var f;return ge(t.dependency,t.license,(f=se(t.dependency))==null?void 0:f.dependencyId)},["stop"]),loading:ee.value===t.dependency,class:"curation-btn",title:"Open this dependency in the curation session for manual license review"},null,8,["onClick","loading"]),s("i",{class:O([M.value.has(o)?"pi pi-chevron-up":"pi pi-chevron-down","expand-icon"])},null,2)])],8,Xs),s("div",et,a(t.message),1),M.value.has(o)?(n(),l("div",st,[se(t.dependency)?(n(),l(I,{key:0},[s("div",tt,[e[29]||(e[29]=s("h4",null,[s("i",{class:"pi pi-question-circle"}),m(" Why This Is a Problem")],-1)),(n(!0),l(I,null,V((c=se(t.dependency))==null?void 0:c.explanations,(r,f)=>(n(),l("div",{key:f,class:"explanation-card"},[s("div",it,[s("i",{class:O("pi "+be(r.type))},null,2),s("strong",null,a(r.title),1)]),s("p",nt,a(r.summary),1),s("ul",lt,[(n(!0),l(I,null,V(r.details,(h,w)=>(n(),l("li",{key:w},a(h),1))),128))]),r.context?(n(),l("div",ot,[r.context.copyleftStrength?(n(),l("span",at," Copyleft: "+a(r.context.copyleftStrength),1)):p("",!0),r.context.riskLevel?(n(),l("span",ct," Risk: "+a(r.context.riskLevel)+"/6 ",1)):p("",!0),r.context.licenseCategory?(n(),l("span",rt,a(r.context.licenseCategory),1)):p("",!0)])):p("",!0)]))),128))]),s("div",dt,[e[33]||(e[33]=s("h4",null,[s("i",{class:"pi pi-wrench"}),m(" How to Fix")],-1)),(n(!0),l(I,null,V((u=se(t.dependency))==null?void 0:u.resolutions,(r,f)=>(n(),l("div",{key:f,class:O(["resolution-card",{recommended:r.recommended}])},[s("div",ut,[s("strong",null,a(r.title),1),r.recommended?(n(),G(d(E),{key:0,value:"Recommended",severity:"success"})):p("",!0),y(d(E),{value:r.effort,severity:Le(r.effort)},null,8,["value","severity"])]),s("p",pt,a(r.description),1),r.steps&&r.steps.length>0?(n(),l("div",vt,[e[30]||(e[30]=s("strong",null,"Steps:",-1)),s("ol",null,[(n(!0),l(I,null,V(r.steps,(h,w)=>(n(),l("li",{key:w},a(h),1))),128))])])):p("",!0),r.tradeoffs&&r.tradeoffs.length>0?(n(),l("div",yt,[e[31]||(e[31]=s("strong",null,"Tradeoffs:",-1)),s("ul",null,[(n(!0),l(I,null,V(r.tradeoffs,(h,w)=>(n(),l("li",{key:w},a(h),1))),128))])])):p("",!0),r.alternatives&&r.alternatives.length>0?(n(),l("div",gt,[e[32]||(e[32]=s("strong",null,"Alternatives:",-1)),s("div",mt,[(n(!0),l(I,null,V(r.alternatives,(h,w)=>(n(),l("div",{key:w,class:"alternative-item"},[s("code",null,a(h.name),1),s("span",ft,a(h.license),1),s("span",ht,a(h.reason),1)]))),128))])])):p("",!0)],2))),128))])],64)):(n(),l("div",_t,[e[35]||(e[35]=s("p",null,[s("i",{class:"pi pi-info-circle"}),m(" Enhanced explanations are not available for this violation.")],-1)),t.suggestion?(n(),l("div",wt,[e[34]||(e[34]=s("i",{class:"pi pi-lightbulb"},null,-1)),m(" "+a(t.suggestion),1)])):p("",!0)]))])):p("",!0)],2)}),128))])])):p("",!0),s("div",Ct,[s("div",St,[s("h2",null,"Dependencies ("+a(ue.value)+")",1),s("div",kt,[g.value?(n(),l("div",Et,[W.value.mustCurate>0?(n(),l("span",Rt,[e[36]||(e[36]=s("i",{class:"pi pi-exclamation-triangle"},null,-1)),m(" "+a(W.value.mustCurate)+" must curate ",1)])):p("",!0),W.value.reviewRecommended>0?(n(),l("span",bt,[e[37]||(e[37]=s("i",{class:"pi pi-eye"},null,-1)),m(" "+a(W.value.reviewRecommended)+" review ",1)])):p("",!0),W.value.safeToIgnore>0?(n(),l("span",Lt,[e[38]||(e[38]=s("i",{class:"pi pi-check"},null,-1)),m(" "+a(W.value.safeToIgnore)+" safe ",1)])):p("",!0),s("span",xt,[e[39]||(e[39]=s("i",{class:"pi pi-check-circle"},null,-1)),m(" "+a(W.value.resolved)+" resolved ",1)])])):p("",!0),Se(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>z.value=t),type:"text",placeholder:"Filter dependencies...",class:"filter-input"},null,512),[[He,z.value]])])]),y(d(Ye),{value:me.value,stripedRows:"",showGridlines:"",class:"p-datatable-sm",paginator:me.value.length>20,rows:20},{default:L(()=>[y(d(H),{header:"Curation",style:{width:"150px"}},{body:L(({data:t})=>[s("div",It,[y(d(E),{value:ye(D(t).category).label,severity:ye(D(t).category).severity,class:"curation-badge"},null,8,["value","severity"]),D(t).category==="MUST_CURATE"||D(t).category==="REVIEW_RECOMMENDED"?(n(),G(d(U),{key:0,icon:"pi pi-pencil",severity:"secondary",size:"small",rounded:"",text:"",onClick:o=>ge(t.name,t.concludedLicense||"",t.id),loading:ee.value===t.name,title:"Review in Curation",class:"curate-btn"},null,8,["onClick","loading"])):p("",!0)])]),_:1}),y(d(H),{field:"name",header:"Package",style:{"min-width":"200px"},sortable:""},{body:L(({data:t})=>[s("div",null,[s("strong",null,a(t.name),1),s("div",Ot,a(t.id),1),D(t).category==="MUST_CURATE"?(n(),l("div",Pt,a(D(t).reasons[0]),1)):p("",!0)])]),_:1}),y(d(H),{field:"version",header:"Version",style:{width:"100px"},sortable:""}),y(d(H),{header:"License",style:{width:"180px"}},{body:L(({data:t})=>{var o,c;return[s("div",Tt,[s("span",{class:O(["license-badge",{"license-unknown":!t.concludedLicense||t.concludedLicense==="UNKNOWN"}])},a(t.concludedLicense||t.declaredLicenses[0]||"Unknown"),3),((o=t.detectedLicenses)==null?void 0:o.length)>0&&t.detectedLicenses.join(",")!==((c=t.declaredLicenses)==null?void 0:c.join(","))?(n(),l("div",Dt,[s("small",null,"Detected: "+a(t.detectedLicenses.slice(0,2).join(", "))+a(t.detectedLicenses.length>2?"...":""),1)])):p("",!0)])]}),_:1}),y(d(H),{header:"Status",style:{width:"100px"}},{body:L(({data:t})=>[t.isResolved?(n(),G(d(E),{key:0,value:"Resolved",severity:"success"})):(n(),G(d(E),{key:1,value:"Unresolved",severity:"warning"}))]),_:1}),y(d(H),{header:"AI Suggestion",style:{"min-width":"200px"}},{body:L(({data:t})=>[t.aiSuggestion?(n(),l("div",Ut,[s("span",Mt,a(t.aiSuggestion.suggestedLicense),1),s("span",{class:O(["confidence",Ne(t.aiSuggestion.confidence)])},a(t.aiSuggestion.confidence),3),s("div",At,a(t.aiSuggestion.reasoning),1)])):(n(),l("span",Nt,"-"))]),_:1}),y(d(H),{header:"SPDX Validation",style:{"min-width":"220px"}},{body:L(({data:t})=>{var o,c,u,r,f,h,w,q,re,X,Y,S;return[(o=t.spdxLicense)!=null&&o.licenseId||(c=t.spdxSuggestion)!=null&&c.licenseId?(n(),l("div",{key:0,class:O(["spdx-container",{"has-hover":((u=t.spdxLicense)==null?void 0:u.licenseId)||((r=t.spdxSuggestion)==null?void 0:r.licenseId)}])},[s("div",{class:"spdx-suggestion",onMouseenter:b=>{var A,N;return ae(b,((A=t.spdxLicense)==null?void 0:A.licenseId)||((N=t.spdxSuggestion)==null?void 0:N.licenseId))},onMouseleave:ce,onFocus:b=>{var A,N;return ae(b,((A=t.spdxLicense)==null?void 0:A.licenseId)||((N=t.spdxSuggestion)==null?void 0:N.licenseId))},onBlur:ce,onKeydown:[we(b=>{var A,N;return ae(b,((A=t.spdxLicense)==null?void 0:A.licenseId)||((N=t.spdxSuggestion)==null?void 0:N.licenseId))},["enter"]),we(ce,["escape"])],tabindex:(f=t.spdxLicense)!=null&&f.licenseId||(h=t.spdxSuggestion)!=null&&h.licenseId?0:-1,title:t.spdxValidated?"Click to view SPDX license details":"SPDX validation failed - click to view suggested license",role:"button","aria-label":`View SPDX license details for ${((w=t.spdxLicense)==null?void 0:w.licenseId)||((q=t.spdxSuggestion)==null?void 0:q.licenseId)}`},[s("div",Ft,[s("span",$t,a(((re=t.spdxLicense)==null?void 0:re.licenseId)||((X=t.spdxSuggestion)==null?void 0:X.licenseId)),1),(Y=t.spdxLicense)!=null&&Y.licenseId||(S=t.spdxSuggestion)!=null&&S.licenseId?(n(),l("i",Bt)):p("",!0)]),s("div",Wt,[y(d(E),{value:t.spdxValidated?"Valid":"Invalid",severity:t.spdxValidated?"success":"warning",class:"spdx-status-badge"},null,8,["value","severity"]),t.spdxSuggestion&&!t.spdxValidated?(n(),l("span",jt," Suggested ")):p("",!0)])],40,Vt)],2)):(n(),l("div",Ht,[...e[40]||(e[40]=[s("span",{class:"no-suggestion"},"Not validated",-1),s("small",{class:"spdx-hint"},"Enable SPDX validation in scan config",-1)])]))]}),_:1})]),_:1},8,["value","paginator"])])],64))],64)):p("",!0),y(ms,{visible:le.value,license:J.value,loading:Z.value,error:Q.value,onMouseenter:$e,onMouseleave:he,onClose:he},null,8,["visible","license","loading","error"])]))}}),Yt=ke(Gt,[["__scopeId","data-v-a5b69aa5"]]);export{Yt as default};
