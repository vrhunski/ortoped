import{d as C,o as R,c as t,b as h,r as c,a as e,e as v,F as y,i as x,j as U,u as V,R as M,n as w,t as o,g as B,v as F,f as j,m as A,h as f,l as E,k as a,_ as I}from"./index-x2f5C-rR.js";const N={class:"scan-detail"},O={key:0,class:"loading"},z={class:"page-header"},H={class:"breadcrumb"},P={class:"scan-meta"},T={key:0,class:"header-actions"},G={key:0,class:"section scanning-state"},$={key:1,class:"section error-state"},q={key:2,class:"section"},J={class:"section-header"},K={class:"data-table"},Q={class:"dep-id"},W={class:"license-badge"},X={key:0,class:"status-badge status-success"},Y={key:1,class:"status-badge status-warning"},Z={key:0,class:"ai-suggestion"},ee={class:"suggested-license"},se={class:"reasoning"},ne={key:1,class:"no-suggestion"},te=C({__name:"ScanDetailView",setup(ae){const u=E(),i=c(null),r=c([]),p=c(!0),b=c(1),m=c(0),d=c(""),k=A(()=>{if(!d.value)return r.value;const l=d.value.toLowerCase();return r.value.filter(s=>{var n;return s.name.toLowerCase().includes(l)||((n=s.concludedLicense)==null?void 0:n.toLowerCase().includes(l))})});async function S(){p.value=!0;try{const l=await f.getScan(u.params.id);if(i.value=l.data,i.value.status==="complete"){const s=await f.getDependencies(u.params.id,b.value,100);r.value=s.data.dependencies,m.value=s.data.total}}catch(l){console.error("Failed to fetch scan data",l)}finally{p.value=!1}}async function L(l){try{const s=await f.generateSbom(u.params.id,l),n=new Blob([s.data.content],{type:"application/json"}),_=URL.createObjectURL(n),g=document.createElement("a");g.href=_,g.download=s.data.filename,g.click(),URL.revokeObjectURL(_)}catch(s){console.error("Failed to download SBOM",s)}}function D(l){switch(l){case"HIGH":return"confidence-high";case"MEDIUM":return"confidence-medium";default:return"confidence-low"}}return R(S),(l,s)=>(a(),t("div",N,[p.value?(a(),t("div",O,[...s[2]||(s[2]=[e("i",{class:"pi pi-spin pi-spinner"},null,-1),v(" Loading... ",-1)])])):i.value?(a(),t(y,{key:1},[e("header",z,[e("div",null,[e("div",H,[x(V(M),{to:"/scans"},{default:U(()=>[...s[3]||(s[3]=[v("Scans",-1)])]),_:1}),s[4]||(s[4]=e("i",{class:"pi pi-angle-right"},null,-1)),s[5]||(s[5]=e("span",null,"Scan Details",-1))]),s[6]||(s[6]=e("h1",null,"Scan Details",-1)),e("div",P,[e("span",{class:w(["status-badge",i.value.status==="complete"?"status-success":"status-warning"])},o(i.value.status),3),e("span",null,"Created: "+o(new Date(i.value.createdAt).toLocaleString()),1)])]),i.value.status==="complete"?(a(),t("div",T,[e("button",{class:"btn btn-secondary",onClick:s[0]||(s[0]=n=>L("cyclonedx-json"))},[...s[7]||(s[7]=[e("i",{class:"pi pi-download"},null,-1),v(" Export SBOM ",-1)])])])):h("",!0)]),i.value.status==="scanning"?(a(),t("div",G,[...s[8]||(s[8]=[e("i",{class:"pi pi-spin pi-spinner"},null,-1),e("h3",null,"Scan in Progress",-1),e("p",null,"Analyzing dependencies and resolving licenses...",-1)])])):i.value.status==="failed"?(a(),t("div",$,[s[9]||(s[9]=e("i",{class:"pi pi-times-circle"},null,-1)),s[10]||(s[10]=e("h3",null,"Scan Failed",-1)),e("p",null,o(i.value.errorMessage||"An unknown error occurred"),1)])):(a(),t("div",q,[e("div",J,[e("h2",null,"Dependencies ("+o(m.value)+")",1),B(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>d.value=n),type:"text",placeholder:"Filter dependencies...",class:"filter-input"},null,512),[[F,d.value]])]),e("table",K,[s[11]||(s[11]=e("thead",null,[e("tr",null,[e("th",null,"Package"),e("th",null,"Version"),e("th",null,"License"),e("th",null,"Status"),e("th",null,"AI Suggestion")])],-1)),e("tbody",null,[(a(!0),t(y,null,j(k.value,n=>(a(),t("tr",{key:n.id},[e("td",null,[e("strong",null,o(n.name),1),e("div",Q,o(n.id),1)]),e("td",null,o(n.version),1),e("td",null,[e("span",W,o(n.concludedLicense||n.declaredLicenses[0]||"Unknown"),1)]),e("td",null,[n.isResolved?(a(),t("span",X,"Resolved")):(a(),t("span",Y,"Unresolved"))]),e("td",null,[n.aiSuggestion?(a(),t("div",Z,[e("span",ee,o(n.aiSuggestion.suggestedLicense),1),e("span",{class:w(["confidence",D(n.aiSuggestion.confidence)])},o(n.aiSuggestion.confidence),3),e("div",se,o(n.aiSuggestion.reasoning),1)])):(a(),t("span",ne,"-"))])]))),128))])])]))],64)):h("",!0)]))}}),oe=I(te,[["__scopeId","data-v-7d1bf914"]]);export{oe as default};
