import{d as pe,g as ve,y as Ee,c as l,a as e,t as o,b as u,e as f,x as j,i as r,u as d,F as R,f as T,k as n,_ as ye,l as De,o as Oe,r as k,j as L,R as q,p as E,q as re,v as Ve,h as I,s as $e,z as ue}from"./index-DW55_gOa.js";import{s as x,a as U,b as Te,c as Fe,d as B}from"./column.esm-DZ9Ak5gf.js";const Ae={class:"license-popup"},Ne={class:"popup-header"},Me={key:0},Ue={key:1},Be={class:"popup-content"},je={key:0,class:"license-loading"},He={key:1,class:"license-error"},Ge={key:2,class:"license-details"},Xe={class:"license-meta"},We={class:"meta-item"},Ke={class:"license-id"},Ye={class:"meta-badges"},qe={key:0,class:"see-also-section"},ze={class:"see-also-list"},Je=["href"],Qe={key:1,class:"header-section"},Ze={class:"license-header"},es={key:2,class:"license-text-section"},ss={class:"license-text"},ts=pe({__name:"LicenseDetailPopup",props:{visible:{type:Boolean},license:{},loading:{type:Boolean},error:{}},emits:["close"],setup(m,{emit:P}){const C=P;return(b,g)=>ve((n(),l("div",Ae,[e("div",Ne,[m.license?(n(),l("h4",Me,o(m.license.name),1)):(n(),l("h4",Ue,"License Details")),e("button",{class:"close-btn",onClick:g[0]||(g[0]=D=>C("close")),"aria-label":"Close"},[...g[1]||(g[1]=[e("i",{class:"pi pi-times"},null,-1)])])]),e("div",Be,[m.loading?(n(),l("div",je,[...g[2]||(g[2]=[e("i",{class:"pi pi-spin pi-spinner"},null,-1),f(" Loading license details... ",-1)])])):m.error?(n(),l("div",He,[g[3]||(g[3]=e("i",{class:"pi pi-exclamation-triangle"},null,-1)),f(" "+o(m.error),1)])):m.license?(n(),l("div",Ge,[e("div",Xe,[e("div",We,[g[4]||(g[4]=e("span",{class:"meta-label"},"License ID",-1)),e("code",Ke,o(m.license.licenseId),1)]),e("div",Ye,[m.license.isOsiApproved?(n(),j(d(x),{key:0,value:"OSI Approved",severity:"success"})):u("",!0),m.license.isFsfLibre?(n(),j(d(x),{key:1,value:"FSF Libre",severity:"info"})):u("",!0),m.license.isDeprecated?(n(),j(d(x),{key:2,value:"Deprecated",severity:"danger"})):u("",!0),r(d(x),{value:m.license.category,severity:"secondary"},null,8,["value"])])]),m.license.seeAlso.length>0?(n(),l("div",qe,[g[6]||(g[6]=e("strong",null,"References:",-1)),e("ul",ze,[(n(!0),l(R,null,T(m.license.seeAlso,D=>(n(),l("li",{key:D},[e("a",{href:D,target:"_blank",rel:"noopener noreferrer"},[g[5]||(g[5]=e("i",{class:"pi pi-external-link"},null,-1)),f(" "+o(D),1)],8,Je)]))),128))])])):u("",!0),m.license.standardHeader?(n(),l("div",Qe,[g[7]||(g[7]=e("strong",null,"Standard License Header:",-1)),e("pre",Ze,o(m.license.standardHeader),1)])):u("",!0),m.license.licenseText?(n(),l("div",es,[g[8]||(g[8]=e("strong",null,"Full License Text:",-1)),e("pre",ss,o(m.license.licenseText),1)])):u("",!0)])):u("",!0)])],512)),[[Ee,m.visible]])}}),ns=ye(ts,[["__scopeId","data-v-0a1bb5b7"]]),is={class:"scan-detail"},ls={key:0,class:"loading"},os={class:"page-header"},as={class:"breadcrumb"},cs={class:"scan-meta"},ds={key:0,class:"header-actions"},rs={key:0,class:"section scanning-state"},us={key:1,class:"section error-state"},ps={class:"compliance-icon"},vs={class:"compliance-info"},ys={class:"compliance-stats"},gs={key:0,class:"stat"},fs={key:1,class:"stat"},ms={key:2,class:"stat"},hs={key:3,class:"stat"},_s={class:"section policy-section"},ks={class:"policy-controls"},ws={class:"policy-selector"},Ss={key:0,class:"no-policies"},xs={class:"section curation-section"},bs={key:0,class:"curation-status"},Cs={class:"curation-info"},Rs={class:"curation-stats"},Ls={class:"stat-item accepted"},Is={class:"stat-item rejected"},Ps={class:"stat-item modified"},Es={key:1,class:"no-curation"},Ds={key:1,class:"section violations-section"},Os={class:"section-header"},Vs={key:0,class:"enhanced-badge"},$s={class:"violations-list"},Ts=["onClick"],Fs={class:"violation-main"},As={class:"dependency-name"},Ns={class:"license-badge"},Ms={class:"rule-name"},Us={class:"violation-expand"},Bs={class:"violation-message"},js={key:0,class:"violation-details"},Hs={class:"explanations-section"},Gs={class:"explanation-header"},Xs={class:"explanation-summary"},Ws={class:"explanation-details"},Ks={key:0,class:"explanation-context"},Ys={key:0,class:"context-tag"},qs={key:1,class:"context-tag"},zs={key:2,class:"context-tag"},Js={class:"resolutions-section"},Qs={class:"resolution-header"},Zs={class:"resolution-description"},et={key:0,class:"resolution-steps"},st={key:1,class:"resolution-tradeoffs"},tt={key:2,class:"resolution-alternatives"},nt={class:"alternatives-list"},it={class:"alt-license"},lt={class:"alt-reason"},ot={key:1,class:"no-enhanced-data"},at={key:0,class:"suggestion"},ct={class:"section"},dt={class:"section-header"},rt={class:"dep-id"},ut={class:"license-badge"},pt={key:0,class:"ai-suggestion"},vt={class:"suggested-license"},yt={class:"reasoning"},gt={key:1,class:"no-suggestion"},ft=["onMouseenter","onFocus","onKeydown","tabindex","title","aria-label"],mt={class:"spdx-license-info"},ht={class:"suggested-license"},_t={key:0,class:"pi pi-info-circle spdx-info-icon"},kt={class:"spdx-status"},wt={key:0,class:"spdx-suggestion-label"},St={key:1,class:"no-spdx"},xt=pe({__name:"ScanDetailView",setup(m){const P=$e(),C=De(),b=k(null),g=k([]),D=k(!0),ee=k(0),X=k(""),F=k([]),A=k(null),H=k(!1),y=k(null),z=k(!1),W=k(null),K=k(!1),Y=k(null),ge=k(null),w=k(null),N=k(!1),O=k(new Set);function fe(i){O.value.has(i)?O.value.delete(i):O.value.add(i),O.value=new Set(O.value)}function J(i){var s,t;return(t=(s=y.value)==null?void 0:s.enhancedViolations)==null?void 0:t.find(a=>a.dependencyName===i)}function me(i){return{WHY_PROHIBITED:"pi-ban",COPYLEFT_RISK:"pi-shield",COMPATIBILITY_ISSUE:"pi-link",OBLIGATION_CONCERN:"pi-file",RISK_LEVEL:"pi-chart-line",PROPAGATION_RISK:"pi-sitemap",USE_CASE_MISMATCH:"pi-crosshairs"}[i]||"pi-info-circle"}function he(i){return{TRIVIAL:"success",LOW:"success",MEDIUM:"warning",HIGH:"danger",SIGNIFICANT:"danger"}[i]||"info"}const se=re(()=>{let i=[...g.value];if(X.value){const s=X.value.toLowerCase();i=i.filter(t=>{var a;return t.name.toLowerCase().includes(s)||((a=t.concludedLicense)==null?void 0:a.toLowerCase().includes(s))})}return i.sort((s,t)=>!s.isResolved&&s.aiSuggestion&&(t.isResolved||!t.aiSuggestion)?-1:!t.isResolved&&t.aiSuggestion&&(s.isResolved||!s.aiSuggestion)?1:!s.isResolved&&t.isResolved?-1:!t.isResolved&&s.isResolved?1:s.name.localeCompare(t.name)),i}),_e=re(()=>F.value.map(i=>({label:i.name+(i.isDefault?" (Default)":""),value:i.id})));async function ke(){D.value=!0;try{const[i,s]=await Promise.all([I.getScan(P.params.id),I.listPolicies(1,100)]);b.value=i.data,F.value=s.data.policies;const t=F.value.find(a=>a.isDefault);if(t?A.value=t.id:F.value.length>0&&(A.value=F.value[0].id),b.value.status==="complete"){const a=[];let p=1;const v=100;let c=!0;for(;c;){const _=await I.getDependencies(P.params.id,p,v);a.push(..._.data.dependencies),ee.value=_.data.total,a.length>=_.data.total?c=!1:p++}g.value=a,await Promise.all([xe(),be()])}}catch(i){console.error("Failed to fetch scan data",i),C.add({severity:"error",summary:"Error",detail:"Failed to fetch scan data",life:3e3})}finally{D.value=!1}}async function we(){var i,s;if(!(!A.value||!b.value)){H.value=!0,y.value=null;try{const a=(await I.evaluatePolicy(b.value.id,A.value)).data,p=JSON.parse(a.report);y.value={policyId:a.policyId,policyName:p.policyName,scanId:a.scanId,passed:a.passed,errorCount:a.errorCount,warningCount:a.warningCount,infoCount:((i=p.summary)==null?void 0:i.infoCount)||0,violations:((s=p.violations)==null?void 0:s.map(v=>({severity:v.severity,rule:v.ruleName,message:v.message,dependency:v.dependencyName,license:v.license,suggestion:v.aiSuggestion})))||[],enhancedViolations:p.enhancedViolations,evaluatedAt:a.createdAt},y.value.passed?C.add({severity:"success",summary:"Policy Check Passed",detail:"No violations found",life:3e3}):C.add({severity:"warn",summary:"Policy Check Failed",detail:`Found ${y.value.errorCount} errors, ${y.value.warningCount} warnings`,life:5e3})}catch(t){console.error("Failed to evaluate policy",t),C.add({severity:"error",summary:"Error",detail:"Failed to run policy check",life:3e3})}finally{H.value=!1}}}async function Se(i){try{const s=await I.generateSbom(P.params.id,i),t=new Blob([s.data.content],{type:"application/json"}),a=URL.createObjectURL(t),p=document.createElement("a");p.href=a,p.download=s.data.filename,p.click(),URL.revokeObjectURL(a)}catch(s){console.error("Failed to download SBOM",s),C.add({severity:"error",summary:"Error",detail:"Failed to download SBOM",life:3e3})}}async function xe(){try{const i=await I.getReportSummary(P.params.id);ge.value=i.data}catch(i){console.error("Failed to fetch report summary",i)}}async function be(){try{const i=await I.getCurationSessionByScan(P.params.id);w.value=i.data}catch{w.value=null}}async function te(i){N.value=!0;try{const s=await I.generateReport(P.params.id,{format:i,includePolicy:!0,includeCuration:!0,includeAuditTrail:!0,includeDependencyDetails:!0}),t=s.data.content,a=s.data.filename,p=i==="html"?"text/html":"application/json",v=new Blob([t],{type:p}),c=URL.createObjectURL(v),_=document.createElement("a");_.href=c,_.download=a,_.click(),URL.revokeObjectURL(c),C.add({severity:"success",summary:"Success",detail:`Report downloaded as ${i.toUpperCase()}`,life:2e3})}catch(s){console.error("Failed to download report",s),C.add({severity:"error",summary:"Error",detail:"Failed to generate report",life:3e3})}finally{N.value=!1}}async function Ce(){N.value=!0;try{const i=await I.downloadOrtExport(P.params.id),s=i.data.content,t=i.data.filename,a=new Blob([s],{type:"application/json"}),p=URL.createObjectURL(a),v=document.createElement("a");v.href=p,v.download=t,v.click(),URL.revokeObjectURL(p),C.add({severity:"success",summary:"Success",detail:"ORT export downloaded",life:2e3})}catch(i){console.error("Failed to download ORT export",i),C.add({severity:"error",summary:"Error",detail:"Failed to generate ORT export",life:3e3})}finally{N.value=!1}}function Re(i){switch(i){case"HIGH":return"confidence-high";case"MEDIUM":return"confidence-medium";default:return"confidence-low"}}function Le(i){switch(i){case"ERROR":return"danger";case"WARNING":return"warning";case"INFO":return"info";default:return"secondary"}}async function Ie(i){K.value=!0,Y.value=null,W.value=null;try{const s=await I.getSpdxLicense(i);W.value=s.data}catch(s){console.error("Failed to fetch license details",s),Y.value="Failed to load license details"}finally{K.value=!1}}function Q(i,s){s&&(M&&(clearTimeout(M),M=null),z.value=!0,Ie(s),setTimeout(()=>{const t=document.querySelector(".license-popup");if(t){const a=t.getBoundingClientRect(),p=window.innerWidth,v=window.innerHeight,c="clientX"in i?i.clientX:p/2,_="clientY"in i?i.clientY:v/2;let h=c+15,S=_+15;h+a.width>p&&(h=c-a.width-15),S+a.height>v&&(S=_-a.height-15),h=Math.max(10,Math.min(h,p-a.width-10)),S=Math.max(10,Math.min(S,v-a.height-10)),t.style.left=h+"px",t.style.top=S+"px",t.style.opacity="1",t.style.transform="scale(1)"}},50))}let M=null;function Z(){M=setTimeout(()=>{ie()},300)}function Pe(){M&&(clearTimeout(M),M=null)}function ne(){ie()}function ie(){const i=document.querySelector(".license-popup");i&&(i.style.opacity="0",i.style.transform="scale(0.95)"),setTimeout(()=>{z.value=!1,setTimeout(()=>{W.value=null,Y.value=null,K.value=!1},200)},150)}return Oe(ke),(i,s)=>(n(),l("div",is,[D.value?(n(),l("div",ls,[...s[5]||(s[5]=[e("i",{class:"pi pi-spin pi-spinner"},null,-1),f(" Loading... ",-1)])])):b.value?(n(),l(R,{key:1},[e("header",os,[e("div",null,[e("div",as,[r(d(q),{to:"/scans"},{default:L(()=>[...s[6]||(s[6]=[f("Scans",-1)])]),_:1}),s[7]||(s[7]=e("i",{class:"pi pi-angle-right"},null,-1)),s[8]||(s[8]=e("span",null,"Scan Details",-1))]),s[9]||(s[9]=e("h1",null,"Scan Details",-1)),e("div",cs,[e("span",{class:E(["status-badge",b.value.status==="complete"?"status-success":"status-warning"])},o(b.value.status),3),e("span",null,"Created: "+o(new Date(b.value.createdAt).toLocaleString()),1)])]),b.value.status==="complete"?(n(),l("div",ds,[r(d(U),{label:"Export SBOM",icon:"pi pi-download",severity:"secondary",onClick:s[0]||(s[0]=t=>Se("cyclonedx-json"))}),r(d(U),{label:"Report (JSON)",icon:"pi pi-file",severity:"secondary",onClick:s[1]||(s[1]=t=>te("json")),loading:N.value},null,8,["loading"]),r(d(U),{label:"Report (HTML)",icon:"pi pi-file",severity:"secondary",onClick:s[2]||(s[2]=t=>te("html")),loading:N.value},null,8,["loading"]),r(d(U),{label:"ORT Export",icon:"pi pi-share-alt",severity:"secondary",onClick:Ce,loading:N.value,title:"Export in ORT Evaluator format"},null,8,["loading"])])):u("",!0)]),b.value.status==="scanning"?(n(),l("div",rs,[...s[10]||(s[10]=[e("i",{class:"pi pi-spin pi-spinner"},null,-1),e("h3",null,"Scan in Progress",-1),e("p",null,"Analyzing dependencies and resolving licenses...",-1)])])):b.value.status==="failed"?(n(),l("div",us,[s[11]||(s[11]=e("i",{class:"pi pi-times-circle"},null,-1)),s[12]||(s[12]=e("h3",null,"Scan Failed",-1)),e("p",null,o(b.value.errorMessage||"An unknown error occurred"),1)])):(n(),l(R,{key:2},[y.value?(n(),l("div",{key:0,class:E(["compliance-banner",y.value.passed?"compliance-passed":"compliance-failed"])},[e("div",ps,[e("i",{class:E(y.value.passed?"pi pi-check-circle":"pi pi-times-circle")},null,2)]),e("div",vs,[e("h3",null,o(y.value.passed?"Policy Check Passed":"Policy Check Failed"),1),e("p",null,"Policy: "+o(y.value.policyName),1)]),e("div",ys,[y.value.errorCount>0?(n(),l("div",gs,[r(d(x),{value:y.value.errorCount,severity:"danger"},null,8,["value"]),s[13]||(s[13]=e("span",null,"Errors",-1))])):u("",!0),y.value.warningCount>0?(n(),l("div",fs,[r(d(x),{value:y.value.warningCount,severity:"warning"},null,8,["value"]),s[14]||(s[14]=e("span",null,"Warnings",-1))])):u("",!0),y.value.infoCount>0?(n(),l("div",ms,[r(d(x),{value:y.value.infoCount,severity:"info"},null,8,["value"]),s[15]||(s[15]=e("span",null,"Info",-1))])):u("",!0),y.value.passed?(n(),l("div",hs,[r(d(x),{value:"0",severity:"success"}),s[16]||(s[16]=e("span",null,"Violations",-1))])):u("",!0)])],2)):u("",!0),e("div",_s,[s[21]||(s[21]=e("div",{class:"section-header"},[e("h2",null,[e("i",{class:"pi pi-shield"}),f(" Policy Compliance")])],-1)),e("div",ks,[e("div",ws,[s[17]||(s[17]=e("label",null,"Select Policy:",-1)),r(d(Te),{modelValue:A.value,"onUpdate:modelValue":s[3]||(s[3]=t=>A.value=t),options:_e.value,optionLabel:"label",optionValue:"value",placeholder:"Select a policy",class:"policy-dropdown",disabled:H.value||F.value.length===0},null,8,["modelValue","options","disabled"])]),r(d(U),{label:"Run Policy Check",icon:"pi pi-play",onClick:we,loading:H.value,disabled:!A.value||H.value},null,8,["loading","disabled"])]),F.value.length===0?(n(),l("p",Ss,[s[19]||(s[19]=f(" No policies available. ",-1)),r(d(q),{to:"/policies"},{default:L(()=>[...s[18]||(s[18]=[f("Create a policy",-1)])]),_:1}),s[20]||(s[20]=f(" to run compliance checks. ",-1))])):u("",!0)]),e("div",xs,[s[26]||(s[26]=e("div",{class:"section-header"},[e("h2",null,[e("i",{class:"pi pi-check-square"}),f(" License Curation")])],-1)),w.value?(n(),l("div",bs,[e("div",Cs,[r(d(x),{value:w.value.status,severity:w.value.status==="APPROVED"?"success":w.value.status==="IN_PROGRESS"?"warning":"info"},null,8,["value","severity"]),e("div",Rs,[e("span",null,[e("strong",null,o(w.value.statistics.total-w.value.statistics.pending),1),f(" / "+o(w.value.statistics.total)+" reviewed",1)]),e("span",Ls,[s[22]||(s[22]=e("i",{class:"pi pi-check"},null,-1)),f(" "+o(w.value.statistics.accepted)+" accepted",1)]),e("span",Is,[s[23]||(s[23]=e("i",{class:"pi pi-times"},null,-1)),f(" "+o(w.value.statistics.rejected)+" rejected",1)]),e("span",Ps,[s[24]||(s[24]=e("i",{class:"pi pi-pencil"},null,-1)),f(" "+o(w.value.statistics.modified)+" modified",1)])])]),r(d(q),{to:`/curations/${w.value.scanId}`},{default:L(()=>[r(d(U),{label:w.value.status==="APPROVED"?"View Curation":"Continue Curation",icon:w.value.status==="APPROVED"?"pi pi-eye":"pi pi-arrow-right",severity:w.value.status==="APPROVED"?"secondary":"primary"},null,8,["label","icon","severity"])]),_:1},8,["to"])])):(n(),l("div",Es,[s[25]||(s[25]=e("p",null,"No curation session started for this scan. Start one to review and approve AI-suggested licenses.",-1)),r(d(q),{to:"/curations"},{default:L(()=>[r(d(U),{label:"Start Curation",icon:"pi pi-plus"})]),_:1})]))]),y.value&&y.value.violations.length>0?(n(),l("div",Ds,[e("div",Os,[e("h2",null,[s[27]||(s[27]=e("i",{class:"pi pi-exclamation-triangle"},null,-1)),f(" Violations ("+o(y.value.violations.length)+")",1)]),y.value.enhancedViolations?(n(),l("span",Vs,[...s[28]||(s[28]=[e("i",{class:"pi pi-sparkles"},null,-1),f(" Enhanced Explanations ",-1)])])):u("",!0)]),e("div",$s,[(n(!0),l(R,null,T(y.value.violations,(t,a)=>{var p,v;return n(),l("div",{key:a,class:E(["violation-card",{expanded:O.value.has(a)}])},[e("div",{class:"violation-header",onClick:c=>fe(a)},[e("div",Fs,[r(d(x),{value:t.severity,severity:Le(t.severity)},null,8,["value","severity"]),e("code",As,o(t.dependency),1),e("span",Ns,o(t.license||"Unknown"),1),e("span",Ms,o(t.rule),1)]),e("div",Us,[e("i",{class:E(O.value.has(a)?"pi pi-chevron-up":"pi pi-chevron-down")},null,2)])],8,Ts),e("div",Bs,o(t.message),1),O.value.has(a)?(n(),l("div",js,[J(t.dependency)?(n(),l(R,{key:0},[e("div",Hs,[s[29]||(s[29]=e("h4",null,[e("i",{class:"pi pi-question-circle"}),f(" Why This Is a Problem")],-1)),(n(!0),l(R,null,T((p=J(t.dependency))==null?void 0:p.explanations,(c,_)=>(n(),l("div",{key:_,class:"explanation-card"},[e("div",Gs,[e("i",{class:E("pi "+me(c.type))},null,2),e("strong",null,o(c.title),1)]),e("p",Xs,o(c.summary),1),e("ul",Ws,[(n(!0),l(R,null,T(c.details,(h,S)=>(n(),l("li",{key:S},o(h),1))),128))]),c.context?(n(),l("div",Ks,[c.context.copyleftStrength?(n(),l("span",Ys," Copyleft: "+o(c.context.copyleftStrength),1)):u("",!0),c.context.riskLevel?(n(),l("span",qs," Risk: "+o(c.context.riskLevel)+"/6 ",1)):u("",!0),c.context.licenseCategory?(n(),l("span",zs,o(c.context.licenseCategory),1)):u("",!0)])):u("",!0)]))),128))]),e("div",Js,[s[33]||(s[33]=e("h4",null,[e("i",{class:"pi pi-wrench"}),f(" How to Fix")],-1)),(n(!0),l(R,null,T((v=J(t.dependency))==null?void 0:v.resolutions,(c,_)=>(n(),l("div",{key:_,class:E(["resolution-card",{recommended:c.recommended}])},[e("div",Qs,[e("strong",null,o(c.title),1),c.recommended?(n(),j(d(x),{key:0,value:"Recommended",severity:"success"})):u("",!0),r(d(x),{value:c.effort,severity:he(c.effort)},null,8,["value","severity"])]),e("p",Zs,o(c.description),1),c.steps&&c.steps.length>0?(n(),l("div",et,[s[30]||(s[30]=e("strong",null,"Steps:",-1)),e("ol",null,[(n(!0),l(R,null,T(c.steps,(h,S)=>(n(),l("li",{key:S},o(h),1))),128))])])):u("",!0),c.tradeoffs&&c.tradeoffs.length>0?(n(),l("div",st,[s[31]||(s[31]=e("strong",null,"Tradeoffs:",-1)),e("ul",null,[(n(!0),l(R,null,T(c.tradeoffs,(h,S)=>(n(),l("li",{key:S},o(h),1))),128))])])):u("",!0),c.alternatives&&c.alternatives.length>0?(n(),l("div",tt,[s[32]||(s[32]=e("strong",null,"Alternatives:",-1)),e("div",nt,[(n(!0),l(R,null,T(c.alternatives,(h,S)=>(n(),l("div",{key:S,class:"alternative-item"},[e("code",null,o(h.name),1),e("span",it,o(h.license),1),e("span",lt,o(h.reason),1)]))),128))])])):u("",!0)],2))),128))])],64)):(n(),l("div",ot,[s[35]||(s[35]=e("p",null,[e("i",{class:"pi pi-info-circle"}),f(" Enhanced explanations are not available for this violation.")],-1)),t.suggestion?(n(),l("div",at,[s[34]||(s[34]=e("i",{class:"pi pi-lightbulb"},null,-1)),f(" "+o(t.suggestion),1)])):u("",!0)]))])):u("",!0)],2)}),128))])])):u("",!0),e("div",ct,[e("div",dt,[e("h2",null,"Dependencies ("+o(ee.value)+")",1),ve(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>X.value=t),type:"text",placeholder:"Filter dependencies...",class:"filter-input"},null,512),[[Ve,X.value]])]),r(d(Fe),{value:se.value,stripedRows:"",showGridlines:"",class:"p-datatable-sm",paginator:se.value.length>20,rows:20},{default:L(()=>[r(d(B),{field:"name",header:"Package",style:{"min-width":"200px"},sortable:""},{body:L(({data:t})=>[e("div",null,[e("strong",null,o(t.name),1),e("div",rt,o(t.id),1)])]),_:1}),r(d(B),{field:"version",header:"Version",style:{width:"120px"},sortable:""}),r(d(B),{header:"License",style:{width:"150px"}},{body:L(({data:t})=>[e("span",ut,o(t.concludedLicense||t.declaredLicenses[0]||"Unknown"),1)]),_:1}),r(d(B),{field:"isResolved",header:"Status",style:{width:"120px"}},{body:L(({data:t})=>[t.isResolved?(n(),j(d(x),{key:0,value:"Resolved",severity:"success"})):(n(),j(d(x),{key:1,value:"Unresolved",severity:"warning"}))]),_:1}),r(d(B),{header:"AI Suggestion",style:{"min-width":"200px"}},{body:L(({data:t})=>[t.aiSuggestion?(n(),l("div",pt,[e("span",vt,o(t.aiSuggestion.suggestedLicense),1),e("span",{class:E(["confidence",Re(t.aiSuggestion.confidence)])},o(t.aiSuggestion.confidence),3),e("div",yt,o(t.aiSuggestion.reasoning),1)])):(n(),l("span",gt,"-"))]),_:1}),r(d(B),{header:"SPDX Validation",style:{"min-width":"220px"}},{body:L(({data:t})=>{var a,p,v,c,_,h,S,le,oe,ae,ce,de;return[(a=t.spdxLicense)!=null&&a.licenseId||(p=t.spdxSuggestion)!=null&&p.licenseId?(n(),l("div",{key:0,class:E(["spdx-container",{"has-hover":((v=t.spdxLicense)==null?void 0:v.licenseId)||((c=t.spdxSuggestion)==null?void 0:c.licenseId)}])},[e("div",{class:"spdx-suggestion",onMouseenter:G=>{var V,$;return Q(G,((V=t.spdxLicense)==null?void 0:V.licenseId)||(($=t.spdxSuggestion)==null?void 0:$.licenseId))},onMouseleave:Z,onFocus:G=>{var V,$;return Q(G,((V=t.spdxLicense)==null?void 0:V.licenseId)||(($=t.spdxSuggestion)==null?void 0:$.licenseId))},onBlur:Z,onKeydown:[ue(G=>{var V,$;return Q(G,((V=t.spdxLicense)==null?void 0:V.licenseId)||(($=t.spdxSuggestion)==null?void 0:$.licenseId))},["enter"]),ue(Z,["escape"])],tabindex:(_=t.spdxLicense)!=null&&_.licenseId||(h=t.spdxSuggestion)!=null&&h.licenseId?0:-1,title:t.spdxValidated?"Click to view SPDX license details":"SPDX validation failed - click to view suggested license",role:"button","aria-label":`View SPDX license details for ${((S=t.spdxLicense)==null?void 0:S.licenseId)||((le=t.spdxSuggestion)==null?void 0:le.licenseId)}`},[e("div",mt,[e("span",ht,o(((oe=t.spdxLicense)==null?void 0:oe.licenseId)||((ae=t.spdxSuggestion)==null?void 0:ae.licenseId)),1),(ce=t.spdxLicense)!=null&&ce.licenseId||(de=t.spdxSuggestion)!=null&&de.licenseId?(n(),l("i",_t)):u("",!0)]),e("div",kt,[r(d(x),{value:t.spdxValidated?"Valid":"Invalid",severity:t.spdxValidated?"success":"warning",class:"spdx-status-badge"},null,8,["value","severity"]),t.spdxSuggestion&&!t.spdxValidated?(n(),l("span",wt," Suggested ")):u("",!0)])],40,ft)],2)):(n(),l("div",St,[...s[36]||(s[36]=[e("span",{class:"no-suggestion"},"Not validated",-1),e("small",{class:"spdx-hint"},"Enable SPDX validation in scan config",-1)])]))]}),_:1})]),_:1},8,["value","paginator"])])],64))],64)):u("",!0),r(ns,{visible:z.value,license:W.value,loading:K.value,error:Y.value,onMouseenter:Pe,onMouseleave:ne,onClose:ne},null,8,["visible","license","loading","error"])]))}}),Rt=ye(xt,[["__scopeId","data-v-ca363d01"]]);export{Rt as default};
